{"ast":null,"code":"import { NodeSelection } from './../../selection/index';\nimport { isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { InsertMethods } from './insert-methods';\n/**\n * Split the Node based on selection\n *\n * @hidden\n\n */\n\nvar NodeCutter =\n/** @class */\nfunction () {\n  function NodeCutter() {\n    this.enterAction = 'P';\n    this.position = -1;\n    this.nodeSelection = new NodeSelection();\n  } // Split Selection Node\n\n  /**\n   * GetSpliceNode method\n   *\n   * @param {Range} range - specifies the range\n   * @param {HTMLElement} node - specifies the node element.\n   * @returns {Node} - returns the node value\n   * @hidden\n    */\n\n\n  NodeCutter.prototype.GetSpliceNode = function (range, node) {\n    node = this.SplitNode(range, node, true);\n    node = this.SplitNode(range, node, false);\n    return node;\n  };\n  /**\n   * @param {Range} range - specifies the range\n   * @param {HTMLElement} node - specifies the node element.\n   * @param {boolean} isCollapsed - specifies the boolean value\n   * @returns {HTMLElement} - returns the element\n   * @hidden\n    */\n\n\n  NodeCutter.prototype.SplitNode = function (range, node, isCollapsed) {\n    if (node) {\n      var clone = range.cloneRange();\n      var parent_1 = node.parentNode;\n      var index = this.nodeSelection.getIndex(node);\n      clone.collapse(isCollapsed); // eslint-disable-next-line\n\n      isCollapsed ? clone.setStartBefore(node) : clone.setEndAfter(node);\n      var fragment = clone.extractContents();\n\n      if (isCollapsed) {\n        node = parent_1.childNodes[index];\n        fragment = this.spliceEmptyNode(fragment, false);\n\n        if (fragment && fragment.childNodes.length > 0) {\n          var isEmpty = fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG' && this.isImgElm(fragment) && fragment.textContent === '' ? true : false;\n\n          if (!isEmpty) {\n            if (node) {\n              InsertMethods.AppendBefore(fragment, node);\n            } else {\n              parent_1.appendChild(fragment);\n              var divNode = document.createElement('div');\n              divNode.innerHTML = '&#65279;&#65279;';\n              node = divNode.firstChild;\n              parent_1.appendChild(node);\n            }\n          }\n        }\n      } else {\n        node = parent_1.childNodes.length > 1 ? parent_1.childNodes[index] : parent_1.childNodes[0];\n        fragment = this.spliceEmptyNode(fragment, true);\n\n        if (fragment && fragment.childNodes.length > 0) {\n          var isEmpty = fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG' && this.isImgElm(fragment) && fragment.textContent.trim() === '' ? true : false;\n\n          if (!isEmpty) {\n            if (node) {\n              InsertMethods.AppendBefore(fragment, node, true);\n            } else {\n              parent_1.appendChild(fragment);\n              var divNode = document.createElement('div');\n              divNode.innerHTML = '&#65279;&#65279;';\n              parent_1.insertBefore(divNode.firstChild, parent_1.firstChild);\n              node = parent_1.firstChild;\n            }\n          }\n        }\n      }\n\n      return node;\n    } else {\n      return null;\n    }\n  };\n\n  NodeCutter.prototype.isImgElm = function (fragment) {\n    var result = true;\n\n    if (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG') {\n      var firstChild = fragment.childNodes[0];\n\n      for (var i = 0; !isNOU(firstChild.childNodes) && i < firstChild.childNodes.length; i++) {\n        if (firstChild.childNodes[i].nodeName === 'IMG') {\n          result = false;\n        }\n      }\n    } else {\n      result = true;\n    }\n\n    return result;\n  };\n\n  NodeCutter.prototype.spliceEmptyNode = function (fragment, isStart) {\n    var len;\n\n    if (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName === '#text' && fragment.childNodes[0].textContent === '' || fragment.textContent === '') {\n      len = -1;\n    } else {\n      len = fragment.childNodes.length - 1;\n    }\n\n    if (len > -1 && !isStart) {\n      this.spliceEmptyNode(fragment.childNodes[len], isStart);\n    } else if (len > -1) {\n      this.spliceEmptyNode(fragment.childNodes[0], isStart);\n    } else if (fragment.nodeType !== 3 && fragment.nodeType !== 11) {\n      fragment.parentNode.removeChild(fragment);\n    }\n\n    return fragment;\n  }; // Cursor Position split\n\n\n  NodeCutter.prototype.GetCursorStart = function (indexes, index, isStart) {\n    indexes = isStart ? indexes : indexes.reverse();\n    var position = indexes[0];\n\n    for (var num = 0; num < indexes.length && (isStart ? indexes[num] < index : indexes[num] >= index); num++) {\n      position = indexes[num];\n    }\n\n    return position;\n  };\n  /**\n   * GetCursorRange method\n   *\n   * @param {Document} docElement - specifies the document\n   * @param {Range} range - specifies the range\n   * @param {Node} node - specifies the node.\n   * @returns {Range} - returns the range value\n   * @hidden\n    */\n\n\n  NodeCutter.prototype.GetCursorRange = function (docElement, range, node) {\n    var cursorRange = docElement.createRange();\n    var indexes = [];\n    indexes.push(0);\n    var str = this.TrimLineBreak(node.data);\n    var index = str.indexOf(' ', 0);\n\n    while (index !== -1) {\n      if (indexes.indexOf(index) < 0) {\n        indexes.push(index);\n      }\n\n      if (new RegExp('\\\\s').test(str[index - 1]) && indexes.indexOf(index - 1) < 0) {\n        indexes.push(index - 1);\n      }\n\n      if (new RegExp('\\\\s').test(str[index + 1])) {\n        indexes.push(index + 1);\n      }\n\n      index = str.indexOf(' ', index + 1);\n    }\n\n    indexes.push(str.length);\n\n    if (indexes.indexOf(range.startOffset) >= 0 || indexes.indexOf(range.startOffset - 1) >= 0 && (range.startOffset !== 1 || range.startOffset === 1 && new RegExp('\\\\s').test(str[0])) || indexes[indexes.length - 1] - 1 === range.startOffset) {\n      cursorRange = range;\n      this.position = 1;\n    } else {\n      var startOffset = this.GetCursorStart(indexes, range.startOffset, true);\n      this.position = range.startOffset - startOffset;\n      cursorRange.setStart(range.startContainer, startOffset);\n      cursorRange.setEnd(range.startContainer, this.GetCursorStart(indexes, range.startOffset, false));\n    }\n\n    return cursorRange;\n  };\n  /**\n   * GetCursorNode method\n   *\n   * @param {Document} docElement - specifies the document\n   * @param {Range} range - specifies the range\n   * @param {Node} node - specifies the node.\n   * @returns {Node} - returns the node value\n   * @hidden\n    */\n\n\n  NodeCutter.prototype.GetCursorNode = function (docElement, range, node) {\n    return this.GetSpliceNode(this.GetCursorRange(docElement, range, node), node);\n  };\n  /**\n   * TrimLineBreak method\n   *\n   * @param {string} line - specifies the string value.\n   * @returns {string} - returns the string\n   * @hidden\n    */\n\n\n  NodeCutter.prototype.TrimLineBreak = function (line) {\n    return line.replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, ' ');\n  };\n\n  return NodeCutter;\n}();\n\nexport { NodeCutter };","map":{"version":3,"sources":["C:/Users/khang/OneDrive/Tài liệu/JS/PersonalDashdoard/dashboard/node_modules/@syncfusion/ej2-react-richtexteditor/node_modules/@syncfusion/ej2-richtexteditor/src/editor-manager/plugin/nodecutter.js"],"names":["NodeSelection","isNullOrUndefined","isNOU","InsertMethods","NodeCutter","enterAction","position","nodeSelection","prototype","GetSpliceNode","range","node","SplitNode","isCollapsed","clone","cloneRange","parent_1","parentNode","index","getIndex","collapse","setStartBefore","setEndAfter","fragment","extractContents","childNodes","spliceEmptyNode","length","isEmpty","nodeName","isImgElm","textContent","AppendBefore","appendChild","divNode","document","createElement","innerHTML","firstChild","trim","insertBefore","result","i","isStart","len","nodeType","removeChild","GetCursorStart","indexes","reverse","num","GetCursorRange","docElement","cursorRange","createRange","push","str","TrimLineBreak","data","indexOf","RegExp","test","startOffset","setStart","startContainer","setEnd","GetCursorNode","line","replace"],"mappings":"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","sourcesContent":["import { NodeSelection } from './../../selection/index';\nimport { isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { InsertMethods } from './insert-methods';\n/**\n * Split the Node based on selection\n *\n * @hidden\n\n */\nvar NodeCutter = /** @class */ (function () {\n    function NodeCutter() {\n        this.enterAction = 'P';\n        this.position = -1;\n        this.nodeSelection = new NodeSelection();\n    }\n    // Split Selection Node\n    /**\n     * GetSpliceNode method\n     *\n     * @param {Range} range - specifies the range\n     * @param {HTMLElement} node - specifies the node element.\n     * @returns {Node} - returns the node value\n     * @hidden\n\n     */\n    NodeCutter.prototype.GetSpliceNode = function (range, node) {\n        node = this.SplitNode(range, node, true);\n        node = this.SplitNode(range, node, false);\n        return node;\n    };\n    /**\n     * @param {Range} range - specifies the range\n     * @param {HTMLElement} node - specifies the node element.\n     * @param {boolean} isCollapsed - specifies the boolean value\n     * @returns {HTMLElement} - returns the element\n     * @hidden\n\n     */\n    NodeCutter.prototype.SplitNode = function (range, node, isCollapsed) {\n        if (node) {\n            var clone = range.cloneRange();\n            var parent_1 = node.parentNode;\n            var index = this.nodeSelection.getIndex(node);\n            clone.collapse(isCollapsed);\n            // eslint-disable-next-line\n            (isCollapsed) ? clone.setStartBefore(node) : clone.setEndAfter(node);\n            var fragment = clone.extractContents();\n            if (isCollapsed) {\n                node = parent_1.childNodes[index];\n                fragment = this.spliceEmptyNode(fragment, false);\n                if (fragment && fragment.childNodes.length > 0) {\n                    var isEmpty = (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG'\n                        && this.isImgElm(fragment) && fragment.textContent === '') ? true : false;\n                    if (!isEmpty) {\n                        if (node) {\n                            InsertMethods.AppendBefore(fragment, node);\n                        }\n                        else {\n                            parent_1.appendChild(fragment);\n                            var divNode = document.createElement('div');\n                            divNode.innerHTML = '&#65279;&#65279;';\n                            node = divNode.firstChild;\n                            parent_1.appendChild(node);\n                        }\n                    }\n                }\n            }\n            else {\n                node = parent_1.childNodes.length > 1 ? parent_1.childNodes[index] :\n                    parent_1.childNodes[0];\n                fragment = this.spliceEmptyNode(fragment, true);\n                if (fragment && fragment.childNodes.length > 0) {\n                    var isEmpty = (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG'\n                        && this.isImgElm(fragment) && fragment.textContent.trim() === '') ? true : false;\n                    if (!isEmpty) {\n                        if (node) {\n                            InsertMethods.AppendBefore(fragment, node, true);\n                        }\n                        else {\n                            parent_1.appendChild(fragment);\n                            var divNode = document.createElement('div');\n                            divNode.innerHTML = '&#65279;&#65279;';\n                            parent_1.insertBefore(divNode.firstChild, parent_1.firstChild);\n                            node = parent_1.firstChild;\n                        }\n                    }\n                }\n            }\n            return node;\n        }\n        else {\n            return null;\n        }\n    };\n    NodeCutter.prototype.isImgElm = function (fragment) {\n        var result = true;\n        if (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName !== 'IMG') {\n            var firstChild = fragment.childNodes[0];\n            for (var i = 0; !isNOU(firstChild.childNodes) && i < firstChild.childNodes.length; i++) {\n                if (firstChild.childNodes[i].nodeName === 'IMG') {\n                    result = false;\n                }\n            }\n        }\n        else {\n            result = true;\n        }\n        return result;\n    };\n    NodeCutter.prototype.spliceEmptyNode = function (fragment, isStart) {\n        var len;\n        if (fragment.childNodes.length === 1 && fragment.childNodes[0].nodeName === '#text' &&\n            fragment.childNodes[0].textContent === '' || fragment.textContent === '') {\n            len = -1;\n        }\n        else {\n            len = fragment.childNodes.length - 1;\n        }\n        if (len > -1 && !isStart) {\n            this.spliceEmptyNode(fragment.childNodes[len], isStart);\n        }\n        else if (len > -1) {\n            this.spliceEmptyNode(fragment.childNodes[0], isStart);\n        }\n        else if (fragment.nodeType !== 3 && fragment.nodeType !== 11) {\n            fragment.parentNode.removeChild(fragment);\n        }\n        return fragment;\n    };\n    // Cursor Position split\n    NodeCutter.prototype.GetCursorStart = function (indexes, index, isStart) {\n        indexes = (isStart) ? indexes : indexes.reverse();\n        var position = indexes[0];\n        for (var num = 0; num < indexes.length && ((isStart) ? (indexes[num] < index) : (indexes[num] >= index)); num++) {\n            position = indexes[num];\n        }\n        return position;\n    };\n    /**\n     * GetCursorRange method\n     *\n     * @param {Document} docElement - specifies the document\n     * @param {Range} range - specifies the range\n     * @param {Node} node - specifies the node.\n     * @returns {Range} - returns the range value\n     * @hidden\n\n     */\n    NodeCutter.prototype.GetCursorRange = function (docElement, range, node) {\n        var cursorRange = docElement.createRange();\n        var indexes = [];\n        indexes.push(0);\n        var str = this.TrimLineBreak(node.data);\n        var index = str.indexOf(' ', 0);\n        while (index !== -1) {\n            if (indexes.indexOf(index) < 0) {\n                indexes.push(index);\n            }\n            if (new RegExp('\\\\s').test(str[index - 1]) && (indexes.indexOf(index - 1) < 0)) {\n                indexes.push(index - 1);\n            }\n            if (new RegExp('\\\\s').test(str[index + 1])) {\n                indexes.push(index + 1);\n            }\n            index = str.indexOf(' ', (index + 1));\n        }\n        indexes.push(str.length);\n        if ((indexes.indexOf(range.startOffset) >= 0)\n            || ((indexes.indexOf(range.startOffset - 1) >= 0) && (range.startOffset !== 1\n                || (range.startOffset === 1 && new RegExp('\\\\s').test(str[0])))\n                || ((indexes[indexes.length - 1] - 1) === range.startOffset))) {\n            cursorRange = range;\n            this.position = 1;\n        }\n        else {\n            var startOffset = this.GetCursorStart(indexes, range.startOffset, true);\n            this.position = range.startOffset - startOffset;\n            cursorRange.setStart(range.startContainer, startOffset);\n            cursorRange.setEnd(range.startContainer, this.GetCursorStart(indexes, range.startOffset, false));\n        }\n        return cursorRange;\n    };\n    /**\n     * GetCursorNode method\n     *\n     * @param {Document} docElement - specifies the document\n     * @param {Range} range - specifies the range\n     * @param {Node} node - specifies the node.\n     * @returns {Node} - returns the node value\n     * @hidden\n\n     */\n    NodeCutter.prototype.GetCursorNode = function (docElement, range, node) {\n        return this.GetSpliceNode(this.GetCursorRange(docElement, range, node), node);\n    };\n    /**\n     * TrimLineBreak method\n     *\n     * @param {string} line - specifies the string value.\n     * @returns {string} - returns the string\n     * @hidden\n\n     */\n    NodeCutter.prototype.TrimLineBreak = function (line) {\n        return line.replace(/(\\r\\n\\t|\\n|\\r\\t)/gm, ' ');\n    };\n    return NodeCutter;\n}());\nexport { NodeCutter };\n"]},"metadata":{},"sourceType":"module"}