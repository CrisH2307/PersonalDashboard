{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil, setDisplayValue, generateExpandPredicates, getPredicates, getGroupKeysAndFields } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport * as literals from '../base/string-literals';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n *\n * @hidden\n */\n\nvar GroupLazyLoadRenderer =\n/** @class */\nfunction (_super) {\n  __extends(GroupLazyLoadRenderer, _super);\n\n  function GroupLazyLoadRenderer(parent, locator) {\n    var _this = _super.call(this, parent, locator) || this;\n\n    _this.childCount = 0;\n    _this.scrollData = [];\n    _this.isFirstChildRow = false;\n    _this.isScrollDown = false;\n    _this.isScrollUp = false;\n    _this.groupCache = {};\n    _this.startIndexes = {};\n    _this.captionCounts = {};\n    _this.rowsByUid = {};\n    _this.objIdxByUid = {};\n    _this.initialGroupCaptions = {};\n    _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete', 'filterbeforeopen', 'filterchoicerequest'];\n    /** @hidden */\n\n    _this.cacheMode = false;\n    /** @hidden */\n\n    _this.cacheBlockSize = 5;\n    /** @hidden */\n\n    _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n    /** @hidden */\n\n    _this.allowCaseSensitive = false;\n    _this.locator = locator;\n    _this.groupGenerator = new GroupModelGenerator(_this.parent);\n    _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n    _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n    _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n\n    _this.eventListener();\n\n    return _this;\n  }\n\n  GroupLazyLoadRenderer.prototype.eventListener = function () {\n    this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n    this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n    this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n    this.parent.on(events.setGroupCache, this.setCache, this);\n    this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n    this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n    this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n  };\n  /**\n   * @param {HTMLTableRowElement} tr - specifies the table row element\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n    var _this = this;\n\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var oriIndex = this.getRowObjectIndexByUid(uid);\n    var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n    var data = rowsObject[oriIndex];\n    var key = getGroupKeysAndFields(oriIndex, rowsObject);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: data,\n      enableCaching: true,\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.keys = key.keys;\n      args.fields = key.fields;\n      args.rowIndex = tr.rowIndex;\n      args.makeRequest = !args.enableCaching || !isRowExist;\n\n      if (!args.enableCaching && isRowExist) {\n        _this.clearCache([uid]);\n      }\n\n      args.skip = 0;\n      args.take = _this.pageSize;\n      data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n\n      _this.captionRowExpand(args);\n    });\n  };\n  /**\n   * @param {HTMLTableRowElement} tr - specifies the table row element\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n    var _this = this;\n\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var rowIdx = tr.rowIndex;\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var e = {\n      captionRowElement: tr,\n      groupInfo: cache[captionIndex],\n      cancel: false\n    };\n    this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n      if (args.cancel) {\n        return;\n      }\n\n      args.isExpand = false;\n\n      _this.removeRows(captionIndex, rowIdx);\n    });\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n    this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n    this.blockSize = Math.ceil(this.pageSize / 2);\n  };\n  /**\n   * @returns {void}\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n    this.clearCache();\n  };\n\n  GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n    uids = uids ? uids : this.getInitialCaptionIndexes();\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (uids.length) {\n      for (var i = 0; i < uids.length; i++) {\n        var capIdx = this.getRowObjectIndexByUid(uids[i]);\n        var capRow = cache[capIdx];\n\n        if (!capRow) {\n          continue;\n        }\n\n        if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n          for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n            if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n              break;\n            }\n\n            if (cache[i_1].isCaptionRow) {\n              delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n            }\n          }\n        }\n\n        if (capRow.isExpand) {\n          var tr = this.parent.getRowElementByUID(capRow.uid);\n\n          if (!tr) {\n            return;\n          }\n\n          this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n        }\n\n        var child = this.getNextChilds(capIdx);\n\n        if (!child.length) {\n          continue;\n        }\n\n        var subChild = [];\n\n        if (child[child.length - 1].isCaptionRow) {\n          subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n        }\n\n        var start = cache.indexOf(child[0]);\n        var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n        cache.splice(start, end - (start - 1));\n        this.refreshCaches();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n\n    for (var i = 0; i < cache.length; i++) {\n      this.maintainRows(cache[i], i);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n    var page = this.parent.pageSettings.currentPage;\n    var uids = [];\n\n    for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n      uids.push(this.initialGroupCaptions[page][i].uid);\n    }\n\n    return uids;\n  };\n  /**\n   * @param {string} uid - specifies the uid\n   * @returns {number} returns the row object uid\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n    return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n    if (this.parent.groupSettings.columns.length && args.target && parentsUntil(args.target, literals.content) && args.target.parentElement.tagName === 'TR') {\n      if (!args.collapse && parentsUntil(args.target, literals.row)) {\n        return;\n      }\n\n      var row = args.target.parentElement;\n      var uid = row.getAttribute('data-uid');\n\n      if (args.collapse) {\n        var rowObj = this.getRowByUid(uid);\n        var capRow = this.getRowByUid(rowObj.parentUid);\n\n        if (capRow.isCaptionRow && capRow.isExpand) {\n          var capEle = this.getRowElementByUid(rowObj.parentUid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n        }\n      } else {\n        var capRow = this.getRowByUid(uid);\n\n        if (capRow.isCaptionRow && !capRow.isExpand) {\n          var capEle = this.getRowElementByUid(uid);\n          this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n    return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n  };\n\n  GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n    if (!args.cancel) {\n      if (!this.requestType.some(function (value) {\n        return value === args.requestType;\n      })) {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n\n      if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n        var keys = Object.keys(this.groupCache);\n\n        for (var j = 0; j < keys.length; j++) {\n          var cache = this.groupCache[keys[j]];\n\n          for (var i = 0; i < cache.length; i++) {\n            if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(cache[i], null, keys[j]);\n            }\n\n            if (cache[i].isDataRow) {\n              var from = args.fromIndex + cache[i].indent;\n              var to = args.toIndex + cache[i].indent;\n              this.moveCells(cache[i].cells, from, to);\n            }\n          }\n        }\n      }\n\n      if (args.requestType === 'delete' || args.action === 'add' && args.requestType === 'save') {\n        this.groupCache = {};\n        this.resetRowMaintenance();\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n    if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit' && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n      this.scrollReset();\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n    this.startIndexes = {};\n    this.captionCounts = {};\n    this.rowsByUid = {};\n    this.objIdxByUid = {};\n    this.initialGroupCaptions = {};\n  };\n\n  GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n    if (from >= arr.length) {\n      var k = from - arr.length;\n\n      while (k-- + 1) {\n        arr.push(undefined);\n      }\n    }\n\n    arr.splice(from, 0, arr.splice(to, 1)[0]);\n  };\n\n  GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var aggUid;\n\n    if (this.parent.aggregates.length) {\n      var agg = this.getAggregateByCaptionIndex(idx);\n      aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n    }\n\n    var indent = rows[idx].indent;\n    this.addClass(this.getNextChilds(idx));\n    rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n    var capUid;\n\n    for (var i = idx + 1; i < rows.length; i++) {\n      if (rows[i].indent === indent || rows[i].indent < indent) {\n        capUid = rows[i].uid;\n        break;\n      }\n\n      if (rows[i].isCaptionRow && rows[i].isExpand) {\n        this.addClass(this.getNextChilds(i));\n      }\n    }\n\n    for (var i = trIdx + 1; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === capUid) {\n        break;\n      } else if (trs[i].getAttribute('data-uid') === aggUid) {\n        remove(trs[i]);\n        break;\n      } else {\n        remove(trs[i]);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n    var last = rows[this.blockSize];\n\n    if (last) {\n      last.lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n    var group = this.groupCache[this.parent.pageSettings.currentPage];\n    var rows = rowObjects ? rowObjects : group;\n    var indent = group[index].indent + 1;\n    var childRows = [];\n\n    for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n      if (rows[i].indent < indent) {\n        break;\n      }\n\n      if (rows[i].indent === indent) {\n        childRows.push(rows[i]);\n      }\n    }\n\n    return childRows;\n  };\n\n  GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n    this.setStartIndexes();\n    var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n    var uid = tr.getAttribute('data-uid');\n    var captionIndex = this.getRowObjectIndexByUid(uid);\n    var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n    var rows = args.isRowExist ? args.isScroll ? this.scrollData : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n    this.scrollData = [];\n\n    if (!args.isRowExist) {\n      this.setRowIndexes(captionIndex, captionRow);\n      this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n\n      if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n        for (var i = 0; i < args.data.length; i++) {\n          var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n          rows.push(data);\n\n          if (this.parent.aggregates.length) {\n            rows = rows.concat(this.summaryModelGen.generateRows(args.data[i], {\n              level: args.level + 1,\n              parentUid: data.uid\n            }));\n          }\n        }\n      } else {\n        this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n        rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n      }\n    }\n\n    var trIdx = args.isScroll ? this.rowIndex : args.index;\n    var nxtChild = this.getNextChilds(captionIndex, rows);\n    var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n\n    if (!args.isRowExist && !lastRow) {\n      nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n    }\n\n    if (!lastRow) {\n      nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n    }\n\n    var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n\n    if (!args.up) {\n      if (!args.isRowExist) {\n        this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n      }\n    }\n\n    this.render(trIdx, rows, lastRow, aggregates);\n\n    if (this.isFirstChildRow && !args.up) {\n      this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n    }\n\n    this.isFirstChildRow = false;\n    this.rowIndex = undefined;\n    this.rowObjectIndex = undefined;\n    this.childCount = 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n    if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n      this.captionCounts[this.parent.pageSettings.currentPage] = {};\n    }\n\n    if (row.isCaptionRow) {\n      this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n\n    if (isScroll) {\n      return cache[this.rowObjectIndex].index + 1;\n    }\n\n    var count = 0;\n    var idx = 0;\n    var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n\n    if (prevCapRow) {\n      idx = this.prevCaptionCount(prevCapRow);\n    }\n\n    if (cache[capIdx].indent > 0) {\n      for (var i = capIdx - 1; i >= 0; i--) {\n        if (cache[i].indent < cache[capIdx].indent) {\n          break;\n        }\n\n        if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n          count = count + cache[i].data.count;\n        }\n      }\n    }\n\n    var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n    var page = this.parent.pageSettings.currentPage;\n    var cache = this.groupCache[page];\n    var idx = 0;\n\n    for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n      if (cache[i].indent === 0) {\n        break;\n      }\n\n      if (cache[i].indent < prevCapRow.indent) {\n        break;\n      }\n\n      if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n        var count = this.captionCounts[page][cache[i].uid];\n        idx = idx + (count ? count : cache[i].data.count);\n      }\n    }\n\n    var capRow = this.getRowByUid(prevCapRow.parentUid);\n\n    if (capRow) {\n      idx = idx + this.prevCaptionCount(capRow);\n    }\n\n    return idx;\n  };\n\n  GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n      var indexes = [];\n      var idx = void 0;\n\n      for (var i = 0; i < cache.length; i++) {\n        if (cache[i].isCaptionRow) {\n          if (!indexes.length) {\n            indexes.push(0);\n          } else {\n            indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n          }\n\n          idx = i;\n        }\n      }\n\n      this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n    return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n    row.data.count = count;\n  };\n\n  GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n    var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n    var scrollEle = this.parent.getContent().firstElementChild;\n    var rowHeight = this.parent.getRowHeight();\n\n    if (tr && aggregates.length) {\n      for (var i = aggregates.length - 1; i >= 0; i--) {\n        tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n      }\n    }\n\n    if (tr && rows.length) {\n      for (var i = rows.length - 1; i >= 0; i--) {\n        if (this.confirmRowRendering(rows[i])) {\n          tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n\n          if (this.isScrollDown) {\n            scrollEle.scrollTop = scrollEle.scrollTop - rowHeight;\n          }\n\n          if (this.isScrollUp) {\n            scrollEle.scrollTop = scrollEle.scrollTop + rowHeight;\n          }\n        }\n      }\n    }\n\n    this.isScrollDown = false;\n    this.isScrollUp = false;\n  };\n  /**\n   * @param {Row<Column>} row - specifies the row\n   * @param {number} index - specifies the index\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n\n    if (!this.rowsByUid[page]) {\n      this.rowsByUid[page] = {};\n      this.objIdxByUid[page] = {};\n    }\n\n    if (row.uid) {\n      this.rowsByUid[page][row.uid] = row;\n    }\n\n    this.objIdxByUid[page][row.uid] = index;\n  };\n\n  GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n    var check = true;\n\n    if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n      var cap = this.getRowByUid(row.parentUid);\n\n      if (cap.isCaptionRow && !cap.isExpand) {\n        check = false;\n      }\n    }\n\n    return check;\n  };\n\n  GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rowsObject = this.groupCache[page];\n    this.rowsByUid[page] = {};\n    this.objIdxByUid[page] = {};\n    var newRowsObject = [];\n    var k = 0;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (i === index) {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n\n        for (var j = 0; j < newRows.length; j++) {\n          this.maintainRows(newRows[j], k);\n          newRowsObject.push(newRows[j]);\n          k++;\n        }\n      } else {\n        this.maintainRows(rowsObject[i], k);\n        newRowsObject.push(rowsObject[i]);\n        k++;\n      }\n    }\n\n    this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n    this.updateCurrentViewData();\n  };\n\n  GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n    var parent = cache[index];\n    var indent = parent.indent;\n    var uid = parent.uid;\n    var agg = [];\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].indent === indent) {\n        break;\n      }\n\n      if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n        agg.push(cache[i]);\n      }\n    }\n\n    return agg;\n  };\n\n  GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n    var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n    var parentRow = cache[index];\n    var agg = [];\n\n    if (!parentRow.isCaptionRow || parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg) {\n      return [];\n    }\n\n    if (includeAgg && this.parent.aggregates.length) {\n      agg = this.getAggregateByCaptionIndex(index);\n    }\n\n    var indent = parentRow.indent;\n    var uid = parentRow.uid;\n    var rows = [];\n    var count = 0;\n\n    for (var i = index + 1; i < cache.length; i++) {\n      if (cache[i].parentUid === uid) {\n        if (isNullOrUndefined(cache[i].indent)) {\n          continue;\n        }\n\n        count++;\n        rows.push(cache[i]);\n\n        if (deep && cache[i].isCaptionRow) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n        }\n\n        if (block && count === this.pageSize) {\n          break;\n        }\n      }\n\n      if (cache[i].indent === indent) {\n        break;\n      }\n    }\n\n    return rows.concat(agg);\n  };\n  /**\n   * @param {boolean} isReorder - specifies the isreorder\n   * @returns {Row<Column>[]} returns the row\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n    var rows = [];\n    var cache = this.groupCache[this.parent.pageSettings.currentPage];\n\n    if (isReorder) {\n      return this.getRenderedRowsObject();\n    }\n\n    for (var i = 0; i < cache.length; i++) {\n      if (cache[i].indent === 0) {\n        rows.push(cache[i]);\n        rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n      }\n    }\n\n    return rows;\n  };\n  /**\n   * @returns {Row<Column>[]} retruns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n    var rows = [];\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n\n    for (var i = 0; i < trs.length; i++) {\n      rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var k = index;\n\n    for (var i = 0; i < this.pageSize; i++) {\n      if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n        break;\n      }\n\n      if (rowsObject[k].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[k]);\n\n        if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n        }\n      }\n\n      if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n        i--;\n      }\n\n      k++;\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n    var rows = [];\n    var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n    var str = false;\n\n    for (var i = 0; i < rowsObject.length; i++) {\n      if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n        break;\n      }\n\n      if (!str && rowsObject[i].uid === start) {\n        str = true;\n      }\n\n      if (str && rowsObject[i].indent === rowsObject[index].indent) {\n        rows.push(rowsObject[i]);\n\n        if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n          rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n        }\n      }\n    }\n\n    return rows;\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n    if (this.parent.isDestroyed || this.childCount) {\n      return;\n    }\n\n    var downTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-down'));\n    var upTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-up'));\n    var endTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-not-lazyload-end'));\n    var tr;\n    var lazyLoadDown = false;\n    var lazyLoadUp = false;\n    var lazyLoadEnd = false;\n\n    if (e.scrollDown && downTrs.length) {\n      var result = this.findRowElements(downTrs);\n      tr = result.tr;\n      lazyLoadDown = result.entered;\n    }\n\n    if (!e.scrollDown && endTrs) {\n      for (var i = 0; i < endTrs.length; i++) {\n        var top_1 = endTrs[i].getBoundingClientRect().top;\n        var scrollHeight = this.parent.getContent().scrollHeight;\n\n        if (top_1 > 0 && top_1 < scrollHeight) {\n          tr = endTrs[i];\n          lazyLoadEnd = true;\n          this.rowIndex = tr.rowIndex;\n          break;\n        }\n      }\n    }\n\n    if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n      var result = this.findRowElements(upTrs);\n      tr = result.tr;\n      lazyLoadUp = result.entered;\n    }\n\n    if (tr) {\n      if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n        this.scrollDownHandler(tr);\n      }\n\n      if (!e.scrollDown && lazyLoadEnd && tr) {\n        this.scrollUpEndRowHandler(tr);\n      }\n\n      if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n        this.scrollUpHandler(tr);\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n\n    if (currentPage === 1) {\n      return;\n    }\n\n    this.childCount = currentPage * this.pageSize;\n    index = this.getCurrentBlockEndIndex(childRow, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      tr.classList.remove('e-not-lazyload-end');\n      childRow.lazyLoadCssClass = '';\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n      var key = getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: key.fields,\n        keys: key.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount >= this.pageSize * this.cacheBlockSize) {\n        var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_1.indexOf(rows[idx]) / this.pageSize);\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n        this.removeBlock(uid, isRowExist, removeBlock, child_1);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var index = this.getRowObjectIndexByUid(uid);\n    var idx = index;\n    var childRow = rows[index];\n    var parentCapRow = this.getRowByUid(childRow.parentUid);\n    var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(childRow);\n    var currentPage = Math.ceil(childIdx / this.pageSize);\n    this.childCount = currentPage * this.pageSize;\n    index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n    var lastchild = rows[index];\n    var lastRow = this.getRowElementByUid(lastchild.uid);\n    this.rowIndex = lastRow.rowIndex;\n    index = this.getCurrentBlockEndIndex(lastchild, index);\n\n    if (this.childCount < parentCapRow.data.count) {\n      var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n\n      if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n        this.childCount = 0;\n        return;\n      }\n\n      if (currentPage > 1 || !this.cacheMode) {\n        tr.classList.remove('e-lazyload-middle-down');\n        lastRow.classList.remove('e-not-lazyload-end');\n        lastchild.lazyLoadCssClass = '';\n      }\n\n      this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n      var query = getGroupKeysAndFields(capRowObjIdx, rows);\n      var args = {\n        rowIndex: capRowEleIndex,\n        makeRequest: !isRowExist,\n        groupInfo: parentCapRow,\n        fields: query.fields,\n        keys: query.keys,\n        skip: this.childCount,\n        take: this.pageSize,\n        isScroll: true\n      };\n\n      if (this.cacheMode && this.childCount - this.pageSize >= this.pageSize * this.cacheBlockSize) {\n        this.isScrollDown = true;\n        var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n        var currenBlock = Math.ceil(child_2.indexOf(rows[idx]) / this.pageSize) - 1;\n        var removeBlock = currenBlock - (this.cacheBlockSize - 1) + 1;\n        this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n        args.cachedRowIndex = removeBlock * this.pageSize;\n      }\n\n      this.captionRowExpand(args);\n    } else {\n      this.childCount = 0;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n\n    if (row.isCaptionRow) {\n      if (row.isExpand) {\n        var childCount = this.getChildRowsByParentIndex(index, true).length;\n        this.rowIndex = this.rowIndex + childCount;\n      }\n\n      var agg = this.getAggregateByCaptionIndex(index);\n      this.rowObjectIndex = this.rowObjectIndex + agg.length;\n      var idx = index;\n\n      for (var i = idx + 1; i < rows.length; i++) {\n        if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n          index = idx;\n          break;\n        } else {\n          idx++;\n        }\n      }\n    }\n\n    return index;\n  };\n\n  GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid1 = child[(removeBlock + 1) * this.pageSize - 1 - this.blockSize].uid;\n    var uid2 = child[removeBlock * this.pageSize - this.pageSize].uid;\n    var uid3 = child[removeBlock * this.pageSize].uid;\n    var firstIdx = this.getRowObjectIndexByUid(uid1);\n    rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n    this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n\n    if (lastchild) {\n      this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n      this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n      this.getRowByUid(uid2).lazyLoadCssClass = '';\n    }\n\n    if (isRowExist) {\n      this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n    } else {\n      this.uid1 = uid2;\n      this.uid2 = uid3;\n      this.uid3 = lastchild ? lastchild.uid : uid;\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n    var page = this.parent.pageSettings.currentPage;\n    var rows = this.groupCache[page];\n    var uid = tr.getAttribute('data-uid');\n    var row = this.getRowByUid(uid);\n    var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n    var parentCapRow = this.getRowByUid(row.parentUid);\n    var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n    var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n    var capRowEleIndex = captionRowEle.rowIndex;\n    var child = this.getChildRowsByParentIndex(capRowObjIdx);\n    var childIdx = child.indexOf(rows[index]);\n    var currenBlock = Math.floor(childIdx / this.pageSize);\n    var idx = this.blockSize;\n\n    if (this.blockSize * 2 > this.pageSize) {\n      idx = this.blockSize * 2 - this.pageSize;\n      idx = this.blockSize - idx;\n    }\n\n    var start = child[childIdx - (idx - 1) - this.pageSize].uid;\n    var end = child[childIdx - (idx - 1)].uid;\n    this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n    this.isFirstChildRow = currenBlock > 1;\n\n    if (this.isFirstChildRow) {\n      this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n    }\n\n    this.getRowByUid(end).lazyLoadCssClass = '';\n    this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n    var removeBlock = currenBlock + this.cacheBlockSize;\n\n    if (child.length !== parentCapRow.data.count && removeBlock * this.pageSize > child.length) {\n      this.isFirstChildRow = false;\n      this.scrollData[0].lazyLoadCssClass = '';\n      this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n      return;\n    }\n\n    var count = removeBlock * this.pageSize > parentCapRow.data.count ? parentCapRow.data.count : removeBlock * this.pageSize;\n    var size = removeBlock * this.pageSize > parentCapRow.data.count ? this.pageSize - (this.pageSize * removeBlock - parentCapRow.data.count) : this.pageSize;\n    var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n    var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[count - 1].uid;\n    var uid2 = child[count - size].uid;\n    var uid3 = child[count - size - 1].uid;\n    var lastIdx = this.objIdxByUid[page][uid2] - idx;\n\n    if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n      var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n\n      if (trEle) {\n        trEle.classList.add('e-lazyload-middle-down');\n      }\n    }\n\n    this.getRowByUid(uid1).lazyLoadCssClass = '';\n    this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n    this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n    this.removeBottomRows(uid1, uid2, uid3);\n    this.rowIndex = tr.rowIndex - idx;\n\n    if (tr.classList.length > 1) {\n      tr.classList.remove('e-lazyload-middle-up');\n    } else {\n      tr.removeAttribute('class');\n    }\n\n    if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n      this.childCount = 0;\n      this.scrollData = [];\n      return;\n    }\n\n    var key = getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n    var args = {\n      rowIndex: capRowEleIndex,\n      makeRequest: false,\n      groupInfo: parentCapRow,\n      fields: key.fields,\n      keys: key.keys,\n      skip: this.childCount,\n      take: this.pageSize,\n      isScroll: true,\n      scrollUp: true\n    };\n    this.isScrollUp = true;\n    this.captionRowExpand(args);\n  };\n\n  GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n    var entered = false;\n    var tr;\n\n    for (var i = 0; i < rows.length; i++) {\n      var rowIdx = rows[i].rowIndex;\n\n      if (isRowEnteredInGrid(rowIdx, this.parent)) {\n        entered = true;\n        this.rowIndex = rowIdx;\n        tr = rows[i];\n        break;\n      }\n    }\n\n    return {\n      entered: entered,\n      tr: tr\n    };\n  };\n\n  GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n    return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n  };\n\n  GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var start = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid3) {\n        var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n\n        if (tr) {\n          this.rowIndex = tr.rowIndex;\n        }\n\n        break;\n      }\n\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        start = true;\n      }\n\n      if (start) {\n        remove(trs[i]);\n      }\n    }\n  }; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n    var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n    var trigger = false;\n\n    for (var i = 0; i < trs.length; i++) {\n      if (trs[i].getAttribute('data-uid') === uid2) {\n        trigger = true;\n      }\n\n      if (trigger) {\n        remove(trs[i]);\n\n        if (trs[i].getAttribute('data-uid') === uid1) {\n          break;\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.setCache = function (e) {\n    var page = this.parent.pageSettings.currentPage;\n    this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n  };\n\n  GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n    var _this = this;\n\n    var captionRow = args.groupInfo;\n    var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n    var pred = generateExpandPredicates(args.fields, args.keys, this);\n    var predicateList = getPredicates(pred);\n    var lazyLoad = {\n      level: level,\n      skip: args.skip,\n      take: args.take,\n      where: predicateList\n    };\n\n    if (args.makeRequest) {\n      var query = this.parent.renderModule.data.generateQuery(true);\n\n      if (!query.isCountRequired) {\n        query.isCountRequired = true;\n      }\n\n      query.lazyLoad.push({\n        key: 'onDemandGroupInfo',\n        value: lazyLoad\n      });\n      this.parent.showSpinner();\n      this.parent.renderModule.data.getData({}, query).then(function (e) {\n        _this.parent.hideSpinner();\n\n        if (e.result.length === 0) {\n          return;\n        }\n\n        if (_this.cacheMode && _this.uid1 && _this.uid2) {\n          _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n\n          _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n        }\n\n        _this.lazyLoadHandler({\n          data: e.result,\n          count: e.count,\n          level: level,\n          index: args.rowIndex,\n          isRowExist: false,\n          isScroll: args.isScroll,\n          up: false,\n          rowIndex: args.cachedRowIndex\n        });\n      }).catch(function (e) {\n        return _this.parent.renderModule.dataManagerFailure(e, {\n          requestType: 'grouping'\n        });\n      });\n    } else {\n      this.lazyLoadHandler({\n        data: null,\n        count: args.groupInfo.data.count,\n        level: level,\n        index: args.rowIndex,\n        isRowExist: true,\n        isScroll: args.isScroll,\n        up: args.scrollUp,\n        rowIndex: args.cachedRowIndex\n      });\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n    this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n  };\n\n  GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n    var records = [];\n    this.getRows().filter(function (row) {\n      if (row.isDataRow) {\n        records[row.index] = row.data;\n      }\n    });\n    this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n  };\n  /**\n   * @returns {Row<Column>[]} returns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n    return this.groupCache;\n  };\n  /**\n   * @returns {Row<Column>[]} returns the row\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRows = function () {\n    return this.groupCache[this.parent.pageSettings.currentPage] || [];\n  };\n  /**\n   * @returns {Element} returns the element\n   * @hidden */\n\n\n  GroupLazyLoadRenderer.prototype.getRowElements = function () {\n    return [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n  };\n  /**\n   * @param {number} index - specifies the index\n   * @returns {Element} returns the element\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n    var tr = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    var row;\n\n    for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n      if (tr[i].getAttribute(literals.ariaRowIndex) === index.toString()) {\n        row = tr[i];\n        break;\n      }\n    }\n\n    return row;\n  };\n  /**\n   * Tucntion to set the column visibility\n   *\n   * @param {Column[]} columns - specifies the column\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n    var gObj = this.parent;\n    var rows = this.getRows();\n    var testRow;\n    rows.some(function (r) {\n      if (r.isDataRow) {\n        testRow = r;\n      }\n\n      return r.isDataRow;\n    });\n    var contentrows = this.getRows().filter(function (row) {\n      return !row.isDetailRow;\n    });\n\n    for (var i = 0; i < columns.length; i++) {\n      var column = columns[i];\n      var idx = this.parent.getNormalizedColumnIndex(column.uid);\n      var colIdx = this.parent.getColumnIndexByUid(column.uid);\n      var displayVal = column.visible === true ? '' : 'none';\n\n      if (idx !== -1 && testRow && idx < testRow.cells.length) {\n        setStyleAttribute(this.getColGroup().childNodes[idx], {\n          'display': displayVal\n        });\n      }\n\n      this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n\n      if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n        this.parent.updateMediaColumns(column);\n      }\n\n      this.parent.invokedFromMedia = false;\n    }\n  };\n  /**\n   * Function to set display.\n   *\n   * @param {Object} tr - specifies the row object\n   * @param {number} idx - specifies the index\n   * @param {string} displayVal - specifies the display value\n   * @param {Row<Column>[]} rows - specifies the array of rows\n   * @param {number} oriIdx - specifies the index\n   * @returns {void}\n   * @hidden\n   */\n\n\n  GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n    if (!this.parent.groupSettings.columns.length) {\n      setDisplayValue(tr, idx, displayVal, rows);\n    } else {\n      var keys = Object.keys(this.groupCache);\n\n      for (var j = 0; j < keys.length; j++) {\n        var uids = this.rowsByUid[keys[j]];\n        var idxs = Object.keys(uids);\n\n        for (var i = 0; i < idxs.length; i++) {\n          var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n          var row = uids[idxs[i]];\n\n          if (row.isCaptionRow) {\n            if (!this.captionModelGen.isEmpty()) {\n              this.changeCaptionRow(row, tr_1, keys[j]);\n            } else {\n              row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1 : row.cells[row.indent + 1].colSpan - 1;\n\n              if (tr_1) {\n                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n              }\n            }\n          }\n\n          if (row.isDataRow) {\n            this.showAndHideCells(tr_1, idx, displayVal, false);\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n          }\n\n          if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n            row.cells[oriIdx].visible = displayVal === '' ? true : false;\n            row.visible = row.cells.some(function (cell) {\n              return cell.isDataCell && cell.visible;\n            });\n            this.showAndHideCells(tr_1, idx, displayVal, true, row);\n          }\n        }\n      }\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n    var capRow = row;\n    var captionData = row.data;\n    var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n    data.uid = row.uid;\n    data.isExpand = row.isExpand;\n    data.lazyLoadCssClass = row.lazyLoadCssClass;\n    this.rowsByUid[index][row.uid] = data;\n    this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n\n    if (tr) {\n      var tbody = this.parent.getContentTable().querySelector(literals.tbody);\n      tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n    }\n  };\n\n  GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n    if (tr) {\n      var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n      setStyleAttribute(tr.querySelectorAll(cls)[idx], {\n        'display': displayVal\n      });\n\n      if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n        removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n      }\n\n      if (isSummary) {\n        if (row.visible && tr.classList.contains('e-hide')) {\n          removeClass([tr], ['e-hide']);\n        } else if (!row.visible) {\n          addClass([tr], ['e-hide']);\n        }\n      }\n    }\n  };\n\n  return GroupLazyLoadRenderer;\n}(ContentRender);\n\nexport { GroupLazyLoadRenderer };","map":{"version":3,"sources":["C:/Users/khang/OneDrive/Tài liệu/JS/PersonalDashdoard/dashboard/node_modules/@syncfusion/ej2-react-richtexteditor/node_modules/@syncfusion/ej2-grids/src/grid/renderer/group-lazy-load-renderer.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","extend","remove","isNullOrUndefined","setStyleAttribute","removeClass","addClass","ContentRender","events","isRowEnteredInGrid","parentsUntil","setDisplayValue","generateExpandPredicates","getPredicates","getGroupKeysAndFields","RowRenderer","GroupModelGenerator","GroupSummaryModelGenerator","CaptionSummaryModelGenerator","literals","GroupLazyLoadRenderer","_super","parent","locator","_this","call","childCount","scrollData","isFirstChildRow","isScrollDown","isScrollUp","groupCache","startIndexes","captionCounts","rowsByUid","objIdxByUid","initialGroupCaptions","requestType","cacheMode","cacheBlockSize","ignoreAccent","allowFiltering","filterSettings","allowCaseSensitive","groupGenerator","summaryModelGen","captionModelGen","rowRenderer","eventListener","addEventListener","actionBegin","bind","actionComplete","on","initialEnd","setLazyLoadPageSize","setGroupCache","setCache","lazyLoadScrollHandler","scrollHandler","columnVisibilityChanged","setVisible","groupCollapse","collapseShortcut","captionExpand","tr","page","pageSettings","currentPage","rowsObject","uid","getAttribute","oriIndex","getRowObjectIndexByUid","isRowExist","indent","data","key","e","captionRowElement","groupInfo","enableCaching","cancel","trigger","lazyLoadGroupExpand","args","keys","fields","rowIndex","makeRequest","clearCache","skip","take","pageSize","isExpand","captionRowExpand","captionCollapse","cache","rowIdx","captionIndex","lazyLoadGroupCollapse","removeRows","scrollEle","getContent","firstElementChild","blockSize","Math","floor","offsetHeight","getRowHeight","ceil","clearLazyGroupCache","uids","getInitialCaptionIndexes","length","i","capIdx","capRow","i_1","isCaptionRow","getRowElementByUID","groupModule","expandCollapseRows","querySelector","child","getNextChilds","subChild","getChildRowsByParentIndex","indexOf","start","end","splice","refreshCaches","maintainRows","push","groupSettings","columns","target","content","parentElement","tagName","collapse","row","rowObj","getRowByUid","parentUid","capEle","getRowElementByUid","cells","some","value","resetRowMaintenance","j","isEmpty","changeCaptionRow","isDataRow","from","fromIndex","to","toIndex","moveCells","action","scrollReset","arr","k","undefined","idx","trIdx","rows","trs","slice","querySelectorAll","aggUid","aggregates","agg","getAggregateByCaptionIndex","capUid","last","lazyLoadCssClass","index","rowObjects","group","childRows","lazyLoadHandler","setStartIndexes","captionRow","isScroll","setRowIndexes","refreshCaptionRowCount","count","generateCaptionRow","level","parentGid","concat","generateRows","getStartIndex","generateDataRows","nxtChild","lastRow","up","hasLastChildRow","refreshRowObjects","rowObjectIndex","render","scrollTop","prevCapRow","prevCaptionCount","indexes","captionCount","rowCount","rowHeight","insertAdjacentElement","getColumns","confirmRowRendering","check","cap","newRows","newRowsObject","updateCurrentViewData","deep","block","includeAgg","includeCollapseAgg","parentRow","initialGroupRows","isReorder","getRenderedRowsObject","getCacheRowsOnDownScroll","getCacheRowsOnUpScroll","str","isDestroyed","downTrs","getElementsByClassName","upTrs","endTrs","lazyLoadDown","lazyLoadUp","lazyLoadEnd","scrollDown","result","findRowElements","entered","top_1","getBoundingClientRect","top","scrollHeight","scrollDownHandler","scrollUpEndRowHandler","scrollUpHandler","childRow","parentCapRow","capRowObjIdx","captionRowEle","capRowEleIndex","childIdx","getCurrentBlockEndIndex","classList","child_1","currenBlock","removeBlock","cachedRowIndex","lastchild","query","child_2","uid1","uid2","uid3","firstIdx","add","removeTopRows","size","lastIdx","trEle","removeBottomRows","removeAttribute","scrollUp","field","pred","predicateList","lazyLoad","where","renderModule","generateQuery","isCountRequired","showSpinner","getData","then","hideSpinner","catch","dataManagerFailure","records","getRows","filter","currentViewData","getGroupCache","getRowElements","getRowByIndex","ariaRowIndex","toString","gObj","testRow","r","contentrows","isDetailRow","column","getNormalizedColumnIndex","colIdx","getColumnIndexByUid","displayVal","visible","getColGroup","childNodes","setDisplayNone","getDataRows","invokedFromMedia","hideAtMedia","updateMediaColumns","oriIdx","idxs","tr_1","colSpan","showAndHideCells","cell","isDataCell","captionData","tIndex","tbody","getContentTable","replaceChild","isSummary","cls","contains"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { extend, remove, isNullOrUndefined, setStyleAttribute, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { ContentRender } from './content-renderer';\nimport * as events from '../base/constant';\nimport { isRowEnteredInGrid, parentsUntil, setDisplayValue, generateExpandPredicates, getPredicates, getGroupKeysAndFields } from '../base/util';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { GroupSummaryModelGenerator, CaptionSummaryModelGenerator } from '../services/summary-model-generator';\nimport * as literals from '../base/string-literals';\n/**\n * GroupLazyLoadRenderer is used to perform lazy load grouping\n *\n * @hidden\n */\nvar GroupLazyLoadRenderer = /** @class */ (function (_super) {\n    __extends(GroupLazyLoadRenderer, _super);\n    function GroupLazyLoadRenderer(parent, locator) {\n        var _this = _super.call(this, parent, locator) || this;\n        _this.childCount = 0;\n        _this.scrollData = [];\n        _this.isFirstChildRow = false;\n        _this.isScrollDown = false;\n        _this.isScrollUp = false;\n        _this.groupCache = {};\n        _this.startIndexes = {};\n        _this.captionCounts = {};\n        _this.rowsByUid = {};\n        _this.objIdxByUid = {};\n        _this.initialGroupCaptions = {};\n        _this.requestType = ['paging', 'columnstate', 'reorder', 'cancel', 'save', 'beginEdit', 'add', 'delete',\n            'filterbeforeopen', 'filterchoicerequest'];\n        /** @hidden */\n        _this.cacheMode = false;\n        /** @hidden */\n        _this.cacheBlockSize = 5;\n        /** @hidden */\n        _this.ignoreAccent = _this.parent.allowFiltering ? _this.parent.filterSettings.ignoreAccent : false;\n        /** @hidden */\n        _this.allowCaseSensitive = false;\n        _this.locator = locator;\n        _this.groupGenerator = new GroupModelGenerator(_this.parent);\n        _this.summaryModelGen = new GroupSummaryModelGenerator(_this.parent);\n        _this.captionModelGen = new CaptionSummaryModelGenerator(_this.parent);\n        _this.rowRenderer = new RowRenderer(_this.locator, null, _this.parent);\n        _this.eventListener();\n        return _this;\n    }\n    GroupLazyLoadRenderer.prototype.eventListener = function () {\n        this.parent.addEventListener(events.actionBegin, this.actionBegin.bind(this));\n        this.parent.addEventListener(events.actionComplete, this.actionComplete.bind(this));\n        this.parent.on(events.initialEnd, this.setLazyLoadPageSize, this);\n        this.parent.on(events.setGroupCache, this.setCache, this);\n        this.parent.on(events.lazyLoadScrollHandler, this.scrollHandler, this);\n        this.parent.on(events.columnVisibilityChanged, this.setVisible, this);\n        this.parent.on(events.groupCollapse, this.collapseShortcut, this);\n    };\n    /**\n     * @param {HTMLTableRowElement} tr - specifies the table row element\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.captionExpand = function (tr) {\n        var _this = this;\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var oriIndex = this.getRowObjectIndexByUid(uid);\n        var isRowExist = rowsObject[oriIndex + 1] ? rowsObject[oriIndex].indent < rowsObject[oriIndex + 1].indent : false;\n        var data = rowsObject[oriIndex];\n        var key = getGroupKeysAndFields(oriIndex, rowsObject);\n        var e = { captionRowElement: tr, groupInfo: data, enableCaching: true, cancel: false };\n        this.parent.trigger(events.lazyLoadGroupExpand, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.keys = key.keys;\n            args.fields = key.fields;\n            args.rowIndex = tr.rowIndex;\n            args.makeRequest = !args.enableCaching || !isRowExist;\n            if (!args.enableCaching && isRowExist) {\n                _this.clearCache([uid]);\n            }\n            args.skip = 0;\n            args.take = _this.pageSize;\n            data.isExpand = _this.rowsByUid[page][data.uid].isExpand = true;\n            _this.captionRowExpand(args);\n        });\n    };\n    /**\n     * @param {HTMLTableRowElement} tr - specifies the table row element\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.captionCollapse = function (tr) {\n        var _this = this;\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var rowIdx = tr.rowIndex;\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var e = {\n            captionRowElement: tr, groupInfo: cache[captionIndex], cancel: false\n        };\n        this.parent.trigger(events.lazyLoadGroupCollapse, e, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            args.isExpand = false;\n            _this.removeRows(captionIndex, rowIdx);\n        });\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.setLazyLoadPageSize = function () {\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var blockSize = Math.floor(scrollEle.offsetHeight / this.parent.getRowHeight()) - 1;\n        this.pageSize = this.pageSize ? this.pageSize : blockSize * 3;\n        this.blockSize = Math.ceil(this.pageSize / 2);\n    };\n    /**\n     * @returns {void}\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.clearLazyGroupCache = function () {\n        this.clearCache();\n    };\n    GroupLazyLoadRenderer.prototype.clearCache = function (uids) {\n        uids = uids ? uids : this.getInitialCaptionIndexes();\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (uids.length) {\n            for (var i = 0; i < uids.length; i++) {\n                var capIdx = this.getRowObjectIndexByUid(uids[i]);\n                var capRow = cache[capIdx];\n                if (!capRow) {\n                    continue;\n                }\n                if (this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid]) {\n                    for (var i_1 = capIdx + 1; i_1 < cache.length; i_1++) {\n                        if (cache[i_1].indent === capRow.indent || cache[i_1].indent < capRow.indent) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][capRow.uid];\n                            break;\n                        }\n                        if (cache[i_1].isCaptionRow) {\n                            delete this.captionCounts[this.parent.pageSettings.currentPage][cache[i_1].uid];\n                        }\n                    }\n                }\n                if (capRow.isExpand) {\n                    var tr = this.parent.getRowElementByUID(capRow.uid);\n                    if (!tr) {\n                        return;\n                    }\n                    this.parent.groupModule.expandCollapseRows(tr.querySelector('.e-recordplusexpand'));\n                }\n                var child = this.getNextChilds(capIdx);\n                if (!child.length) {\n                    continue;\n                }\n                var subChild = [];\n                if (child[child.length - 1].isCaptionRow) {\n                    subChild = this.getChildRowsByParentIndex(cache.indexOf(child[child.length - 1]), false, false, null, true, true);\n                }\n                var start = cache.indexOf(child[0]);\n                var end = subChild.length ? cache.indexOf(subChild[subChild.length - 1]) : cache.indexOf(child[child.length - 1]);\n                cache.splice(start, end - (start - 1));\n                this.refreshCaches();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaches = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        for (var i = 0; i < cache.length; i++) {\n            this.maintainRows(cache[i], i);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getInitialCaptionIndexes = function () {\n        var page = this.parent.pageSettings.currentPage;\n        var uids = [];\n        for (var i = 0; i < this.initialGroupCaptions[page].length; i++) {\n            uids.push(this.initialGroupCaptions[page][i].uid);\n        }\n        return uids;\n    };\n    /**\n     * @param {string} uid - specifies the uid\n     * @returns {number} returns the row object uid\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.getRowObjectIndexByUid = function (uid) {\n        return this.objIdxByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.collapseShortcut = function (args) {\n        if (this.parent.groupSettings.columns.length &&\n            args.target && parentsUntil(args.target, literals.content) && args.target.parentElement.tagName === 'TR') {\n            if (!args.collapse && parentsUntil(args.target, literals.row)) {\n                return;\n            }\n            var row = args.target.parentElement;\n            var uid = row.getAttribute('data-uid');\n            if (args.collapse) {\n                var rowObj = this.getRowByUid(uid);\n                var capRow = this.getRowByUid(rowObj.parentUid);\n                if (capRow.isCaptionRow && capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(rowObj.parentUid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[rowObj.indent - 1]);\n                }\n            }\n            else {\n                var capRow = this.getRowByUid(uid);\n                if (capRow.isCaptionRow && !capRow.isExpand) {\n                    var capEle = this.getRowElementByUid(uid);\n                    this.parent.groupModule.expandCollapseRows(capEle.cells[capRow.indent]);\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getRowByUid = function (uid) {\n        return this.rowsByUid[this.parent.pageSettings.currentPage][uid];\n    };\n    GroupLazyLoadRenderer.prototype.actionBegin = function (args) {\n        if (!args.cancel) {\n            if (!this.requestType.some(function (value) { return value === args.requestType; })) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n            if (args.requestType === 'reorder' && this.parent.groupSettings.columns.length) {\n                var keys = Object.keys(this.groupCache);\n                for (var j = 0; j < keys.length; j++) {\n                    var cache = this.groupCache[keys[j]];\n                    for (var i = 0; i < cache.length; i++) {\n                        if (cache[i].isCaptionRow && !this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(cache[i], null, keys[j]);\n                        }\n                        if (cache[i].isDataRow) {\n                            var from = args.fromIndex + cache[i].indent;\n                            var to = args.toIndex + cache[i].indent;\n                            this.moveCells(cache[i].cells, from, to);\n                        }\n                    }\n                }\n            }\n            if (args.requestType === 'delete'\n                || (args.action === 'add' && args.requestType === 'save')) {\n                this.groupCache = {};\n                this.resetRowMaintenance();\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.actionComplete = function (args) {\n        if (!args.cancel && args.requestType !== 'columnstate' && args.requestType !== 'beginEdit'\n            && args.requestType !== 'delete' && args.requestType !== 'save' && args.requestType !== 'reorder') {\n            this.scrollReset();\n        }\n    };\n    GroupLazyLoadRenderer.prototype.resetRowMaintenance = function () {\n        this.startIndexes = {};\n        this.captionCounts = {};\n        this.rowsByUid = {};\n        this.objIdxByUid = {};\n        this.initialGroupCaptions = {};\n    };\n    GroupLazyLoadRenderer.prototype.moveCells = function (arr, from, to) {\n        if (from >= arr.length) {\n            var k = from - arr.length;\n            while ((k--) + 1) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(from, 0, arr.splice(to, 1)[0]);\n    };\n    GroupLazyLoadRenderer.prototype.removeRows = function (idx, trIdx) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var aggUid;\n        if (this.parent.aggregates.length) {\n            var agg = this.getAggregateByCaptionIndex(idx);\n            aggUid = agg.length ? agg[agg.length - 1].uid : undefined;\n        }\n        var indent = rows[idx].indent;\n        this.addClass(this.getNextChilds(idx));\n        rows[idx].isExpand = this.rowsByUid[page][rows[idx].uid].isExpand = false;\n        var capUid;\n        for (var i = idx + 1; i < rows.length; i++) {\n            if (rows[i].indent === indent || rows[i].indent < indent) {\n                capUid = rows[i].uid;\n                break;\n            }\n            if (rows[i].isCaptionRow && rows[i].isExpand) {\n                this.addClass(this.getNextChilds(i));\n            }\n        }\n        for (var i = trIdx + 1; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === capUid) {\n                break;\n            }\n            else if (trs[i].getAttribute('data-uid') === aggUid) {\n                remove(trs[i]);\n                break;\n            }\n            else {\n                remove(trs[i]);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.addClass = function (rows) {\n        var last = rows[this.blockSize];\n        if (last) {\n            last.lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getNextChilds = function (index, rowObjects) {\n        var group = this.groupCache[this.parent.pageSettings.currentPage];\n        var rows = rowObjects ? rowObjects : group;\n        var indent = group[index].indent + 1;\n        var childRows = [];\n        for (var i = rowObjects ? 0 : index + 1; i < rows.length; i++) {\n            if (rows[i].indent < indent) {\n                break;\n            }\n            if (rows[i].indent === indent) {\n                childRows.push(rows[i]);\n            }\n        }\n        return childRows;\n    };\n    GroupLazyLoadRenderer.prototype.lazyLoadHandler = function (args) {\n        this.setStartIndexes();\n        var tr = this.parent.getContent().querySelectorAll('tr')[args.index];\n        var uid = tr.getAttribute('data-uid');\n        var captionIndex = this.getRowObjectIndexByUid(uid);\n        var captionRow = this.groupCache[this.parent.pageSettings.currentPage][captionIndex];\n        var rows = args.isRowExist ? args.isScroll ? this.scrollData\n            : this.getChildRowsByParentIndex(captionIndex, true, true, null, true) : [];\n        this.scrollData = [];\n        if (!args.isRowExist) {\n            this.setRowIndexes(captionIndex, captionRow);\n            this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][captionIndex], args.count);\n            if (Object.keys(args.data).indexOf('GroupGuid') !== -1) {\n                for (var i = 0; i < args.data.length; i++) {\n                    var data = this.groupGenerator.generateCaptionRow(args.data[i], args.level, captionRow.parentGid, undefined, 0, captionRow.uid);\n                    rows.push(data);\n                    if (this.parent.aggregates.length) {\n                        rows = rows.concat((this.summaryModelGen.generateRows(args.data[i], { level: args.level + 1, parentUid: data.uid })));\n                    }\n                }\n            }\n            else {\n                this.groupGenerator.index = this.getStartIndex(captionIndex, args.isScroll);\n                rows = this.groupGenerator.generateDataRows(args.data, args.level, captionRow.parentGid, 0, captionRow.uid);\n            }\n        }\n        var trIdx = args.isScroll ? this.rowIndex : args.index;\n        var nxtChild = this.getNextChilds(captionIndex, rows);\n        var lastRow = !args.up ? this.hasLastChildRow(args.isScroll, args.count, nxtChild.length) : true;\n        if (!args.isRowExist && !lastRow) {\n            nxtChild[this.blockSize].lazyLoadCssClass = 'e-lazyload-middle-down';\n        }\n        if (!lastRow) {\n            nxtChild[nxtChild.length - 1].lazyLoadCssClass = 'e-not-lazyload-end';\n        }\n        var aggregates = !args.isScroll && !args.isRowExist ? this.getAggregateByCaptionIndex(captionIndex) : [];\n        if (!args.up) {\n            if (!args.isRowExist) {\n                this.refreshRowObjects(rows, args.isScroll ? this.rowObjectIndex : captionIndex);\n            }\n        }\n        this.render(trIdx, rows, lastRow, aggregates);\n        if (this.isFirstChildRow && !args.up) {\n            this.parent.getContent().firstElementChild.scrollTop = rows.length * this.parent.getRowHeight();\n        }\n        this.isFirstChildRow = false;\n        this.rowIndex = undefined;\n        this.rowObjectIndex = undefined;\n        this.childCount = 0;\n    };\n    GroupLazyLoadRenderer.prototype.setRowIndexes = function (capIdx, row) {\n        if (!this.captionCounts[this.parent.pageSettings.currentPage]) {\n            this.captionCounts[this.parent.pageSettings.currentPage] = {};\n        }\n        if (row.isCaptionRow) {\n            this.captionCounts[this.parent.pageSettings.currentPage][row.uid] = row.data.count;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getStartIndex = function (capIdx, isScroll) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        if (isScroll) {\n            return cache[this.rowObjectIndex].index + 1;\n        }\n        var count = 0;\n        var idx = 0;\n        var prevCapRow = this.getRowByUid(cache[capIdx].parentUid);\n        if (prevCapRow) {\n            idx = this.prevCaptionCount(prevCapRow);\n        }\n        if (cache[capIdx].indent > 0) {\n            for (var i = capIdx - 1; i >= 0; i--) {\n                if (cache[i].indent < cache[capIdx].indent) {\n                    break;\n                }\n                if (cache[i].isCaptionRow && cache[i].indent === cache[capIdx].indent) {\n                    count = count + cache[i].data.count;\n                }\n            }\n        }\n        var index = count + idx + this.startIndexes[page][cache[capIdx].parentGid];\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.prevCaptionCount = function (prevCapRow) {\n        var page = this.parent.pageSettings.currentPage;\n        var cache = this.groupCache[page];\n        var idx = 0;\n        for (var i = cache.indexOf(prevCapRow) - 1; i >= 0; i--) {\n            if (cache[i].indent === 0) {\n                break;\n            }\n            if (cache[i].indent < prevCapRow.indent) {\n                break;\n            }\n            if (cache[i].isCaptionRow && cache[i].indent === prevCapRow.indent) {\n                var count = this.captionCounts[page][cache[i].uid];\n                idx = idx + (count ? count : cache[i].data.count);\n            }\n        }\n        var capRow = this.getRowByUid(prevCapRow.parentUid);\n        if (capRow) {\n            idx = idx + this.prevCaptionCount(capRow);\n        }\n        return idx;\n    };\n    GroupLazyLoadRenderer.prototype.setStartIndexes = function () {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (!this.startIndexes[this.parent.pageSettings.currentPage]) {\n            var indexes = [];\n            var idx = void 0;\n            for (var i = 0; i < cache.length; i++) {\n                if (cache[i].isCaptionRow) {\n                    if (!indexes.length) {\n                        indexes.push(0);\n                    }\n                    else {\n                        indexes.push(cache[idx].data.count + indexes[indexes.length - 1]);\n                    }\n                    idx = i;\n                }\n            }\n            this.startIndexes[this.parent.pageSettings.currentPage] = indexes;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.hasLastChildRow = function (isScroll, captionCount, rowCount) {\n        return isScroll ? captionCount === this.childCount + rowCount : captionCount === rowCount;\n    };\n    GroupLazyLoadRenderer.prototype.refreshCaptionRowCount = function (row, count) {\n        row.data.count = count;\n    };\n    GroupLazyLoadRenderer.prototype.render = function (trIdx, rows, hasLastChildRow, aggregates) {\n        var tr = this.parent.getContent().querySelectorAll('tr')[trIdx];\n        var scrollEle = this.parent.getContent().firstElementChild;\n        var rowHeight = this.parent.getRowHeight();\n        if (tr && aggregates.length) {\n            for (var i = aggregates.length - 1; i >= 0; i--) {\n                tr.insertAdjacentElement('afterend', this.rowRenderer.render(aggregates[i], this.parent.getColumns()));\n            }\n        }\n        if (tr && rows.length) {\n            for (var i = rows.length - 1; i >= 0; i--) {\n                if (this.confirmRowRendering(rows[i])) {\n                    tr.insertAdjacentElement('afterend', this.rowRenderer.render(rows[i], this.parent.getColumns()));\n                    if (this.isScrollDown) {\n                        scrollEle.scrollTop = scrollEle.scrollTop - rowHeight;\n                    }\n                    if (this.isScrollUp) {\n                        scrollEle.scrollTop = scrollEle.scrollTop + rowHeight;\n                    }\n                }\n            }\n        }\n        this.isScrollDown = false;\n        this.isScrollUp = false;\n    };\n    /**\n     * @param {Row<Column>} row - specifies the row\n     * @param {number} index - specifies the index\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.maintainRows = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        if (!this.rowsByUid[page]) {\n            this.rowsByUid[page] = {};\n            this.objIdxByUid[page] = {};\n        }\n        if (row.uid) {\n            this.rowsByUid[page][row.uid] = row;\n        }\n        this.objIdxByUid[page][row.uid] = index;\n    };\n    GroupLazyLoadRenderer.prototype.confirmRowRendering = function (row) {\n        var check = true;\n        if (isNullOrUndefined(row.indent) && !row.isDataRow && !row.isCaptionRow) {\n            var cap = this.getRowByUid(row.parentUid);\n            if (cap.isCaptionRow && !cap.isExpand) {\n                check = false;\n            }\n        }\n        return check;\n    };\n    GroupLazyLoadRenderer.prototype.refreshRowObjects = function (newRows, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rowsObject = this.groupCache[page];\n        this.rowsByUid[page] = {};\n        this.objIdxByUid[page] = {};\n        var newRowsObject = [];\n        var k = 0;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (i === index) {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n                for (var j = 0; j < newRows.length; j++) {\n                    this.maintainRows(newRows[j], k);\n                    newRowsObject.push(newRows[j]);\n                    k++;\n                }\n            }\n            else {\n                this.maintainRows(rowsObject[i], k);\n                newRowsObject.push(rowsObject[i]);\n                k++;\n            }\n        }\n        this.groupCache[this.parent.pageSettings.currentPage] = extend([], newRowsObject);\n        this.updateCurrentViewData();\n    };\n    GroupLazyLoadRenderer.prototype.getAggregateByCaptionIndex = function (index) {\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        var parent = cache[index];\n        var indent = parent.indent;\n        var uid = parent.uid;\n        var agg = [];\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].indent === indent) {\n                break;\n            }\n            if (isNullOrUndefined(cache[i].indent) && cache[i].parentUid === uid) {\n                agg.push(cache[i]);\n            }\n        }\n        return agg;\n    };\n    GroupLazyLoadRenderer.prototype.getChildRowsByParentIndex = function (index, deep, block, data, includeAgg, includeCollapseAgg) {\n        var cache = data ? data : this.groupCache[this.parent.pageSettings.currentPage];\n        var parentRow = cache[index];\n        var agg = [];\n        if (!parentRow.isCaptionRow || (parentRow.isCaptionRow && !parentRow.isExpand && !includeCollapseAgg)) {\n            return [];\n        }\n        if (includeAgg && this.parent.aggregates.length) {\n            agg = this.getAggregateByCaptionIndex(index);\n        }\n        var indent = parentRow.indent;\n        var uid = parentRow.uid;\n        var rows = [];\n        var count = 0;\n        for (var i = index + 1; i < cache.length; i++) {\n            if (cache[i].parentUid === uid) {\n                if (isNullOrUndefined(cache[i].indent)) {\n                    continue;\n                }\n                count++;\n                rows.push(cache[i]);\n                if (deep && cache[i].isCaptionRow) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, deep, block, data, includeAgg));\n                }\n                if (block && count === this.pageSize) {\n                    break;\n                }\n            }\n            if (cache[i].indent === indent) {\n                break;\n            }\n        }\n        return rows.concat(agg);\n    };\n    /**\n     * @param {boolean} isReorder - specifies the isreorder\n     * @returns {Row<Column>[]} returns the row\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.initialGroupRows = function (isReorder) {\n        var rows = [];\n        var cache = this.groupCache[this.parent.pageSettings.currentPage];\n        if (isReorder) {\n            return this.getRenderedRowsObject();\n        }\n        for (var i = 0; i < cache.length; i++) {\n            if (cache[i].indent === 0) {\n                rows.push(cache[i]);\n                rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, cache, true));\n            }\n        }\n        return rows;\n    };\n    /**\n     * @returns {Row<Column>[]} retruns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRenderedRowsObject = function () {\n        var rows = [];\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        for (var i = 0; i < trs.length; i++) {\n            rows.push(this.getRowByUid(trs[i].getAttribute('data-uid')));\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnDownScroll = function (index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var k = index;\n        for (var i = 0; i < this.pageSize; i++) {\n            if (!rowsObject[k] || rowsObject[k].indent < rowsObject[index].indent) {\n                break;\n            }\n            if (rowsObject[k].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[k]);\n                if (rowsObject[k].isCaptionRow && rowsObject[k].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(k, true, true, null, true));\n                }\n            }\n            if (rowsObject[k].indent > rowsObject[index].indent || isNullOrUndefined(rowsObject[k].indent)) {\n                i--;\n            }\n            k++;\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.getCacheRowsOnUpScroll = function (start, end, index) {\n        var rows = [];\n        var rowsObject = this.groupCache[this.parent.pageSettings.currentPage];\n        var str = false;\n        for (var i = 0; i < rowsObject.length; i++) {\n            if (str && (!rowsObject[i] || rowsObject[i].indent < rowsObject[index].indent || rowsObject[i].uid === end)) {\n                break;\n            }\n            if (!str && rowsObject[i].uid === start) {\n                str = true;\n            }\n            if (str && rowsObject[i].indent === rowsObject[index].indent) {\n                rows.push(rowsObject[i]);\n                if (rowsObject[i].isCaptionRow && rowsObject[i].isExpand) {\n                    rows = rows.concat(this.getChildRowsByParentIndex(i, true, true, null, true));\n                }\n            }\n        }\n        return rows;\n    };\n    GroupLazyLoadRenderer.prototype.scrollHandler = function (e) {\n        if (this.parent.isDestroyed || this.childCount) {\n            return;\n        }\n        var downTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-down'));\n        var upTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-lazyload-middle-up'));\n        var endTrs = [].slice.call(this.parent.getContent().getElementsByClassName('e-not-lazyload-end'));\n        var tr;\n        var lazyLoadDown = false;\n        var lazyLoadUp = false;\n        var lazyLoadEnd = false;\n        if (e.scrollDown && downTrs.length) {\n            var result = this.findRowElements(downTrs);\n            tr = result.tr;\n            lazyLoadDown = result.entered;\n        }\n        if (!e.scrollDown && endTrs) {\n            for (var i = 0; i < endTrs.length; i++) {\n                var top_1 = endTrs[i].getBoundingClientRect().top;\n                var scrollHeight = this.parent.getContent().scrollHeight;\n                if (top_1 > 0 && top_1 < scrollHeight) {\n                    tr = endTrs[i];\n                    lazyLoadEnd = true;\n                    this.rowIndex = tr.rowIndex;\n                    break;\n                }\n            }\n        }\n        if (!e.scrollDown && upTrs.length && !lazyLoadEnd) {\n            var result = this.findRowElements(upTrs);\n            tr = result.tr;\n            lazyLoadUp = result.entered;\n        }\n        if (tr) {\n            if (lazyLoadDown && e.scrollDown && lazyLoadDown && tr) {\n                this.scrollDownHandler(tr);\n            }\n            if (!e.scrollDown && lazyLoadEnd && tr) {\n                this.scrollUpEndRowHandler(tr);\n            }\n            if (this.cacheMode && !e.scrollDown && !lazyLoadEnd && lazyLoadUp && tr) {\n                this.scrollUpHandler(tr);\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpEndRowHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getContent().querySelector('tr[data-uid=' + parentCapRow.uid + ']');\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        if (currentPage === 1) {\n            return;\n        }\n        this.childCount = currentPage * this.pageSize;\n        index = this.getCurrentBlockEndIndex(childRow, index);\n        if (this.childCount < parentCapRow.data.count) {\n            tr.classList.remove('e-not-lazyload-end');\n            childRow.lazyLoadCssClass = '';\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(index + 1) : [];\n            var key = getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: key.fields,\n                keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && this.childCount >= (this.pageSize * this.cacheBlockSize)) {\n                var child_1 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_1.indexOf(rows[idx]) / this.pageSize));\n                var removeBlock = currenBlock - (this.cacheBlockSize - 1);\n                this.removeBlock(uid, isRowExist, removeBlock, child_1);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollDownHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var index = this.getRowObjectIndexByUid(uid);\n        var idx = index;\n        var childRow = rows[index];\n        var parentCapRow = this.getRowByUid(childRow.parentUid);\n        var capRowObjIdx = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.getRowElementByUid(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(childRow);\n        var currentPage = Math.ceil(childIdx / this.pageSize);\n        this.childCount = currentPage * this.pageSize;\n        index = this.rowObjectIndex = this.getRowObjectIndexByUid(child[this.childCount - 1].uid);\n        var lastchild = rows[index];\n        var lastRow = this.getRowElementByUid(lastchild.uid);\n        this.rowIndex = lastRow.rowIndex;\n        index = this.getCurrentBlockEndIndex(lastchild, index);\n        if (this.childCount < parentCapRow.data.count) {\n            var isRowExist = rows[index + 1] ? childRow.indent === rows[index + 1].indent : false;\n            if (isRowExist && !isNullOrUndefined(this.getRowElementByUid(rows[index + 1].uid))) {\n                this.childCount = 0;\n                return;\n            }\n            if (currentPage > 1 || !this.cacheMode) {\n                tr.classList.remove('e-lazyload-middle-down');\n                lastRow.classList.remove('e-not-lazyload-end');\n                lastchild.lazyLoadCssClass = '';\n            }\n            this.scrollData = isRowExist ? this.getCacheRowsOnDownScroll(this.rowObjectIndex + 1) : [];\n            var query = getGroupKeysAndFields(capRowObjIdx, rows);\n            var args = {\n                rowIndex: capRowEleIndex, makeRequest: !isRowExist, groupInfo: parentCapRow, fields: query.fields,\n                keys: query.keys, skip: this.childCount, take: this.pageSize, isScroll: true\n            };\n            if (this.cacheMode && (this.childCount - this.pageSize) >= (this.pageSize * this.cacheBlockSize)) {\n                this.isScrollDown = true;\n                var child_2 = this.getChildRowsByParentIndex(capRowObjIdx);\n                var currenBlock = Math.ceil((child_2.indexOf(rows[idx]) / this.pageSize)) - 1;\n                var removeBlock = (currenBlock - (this.cacheBlockSize - 1)) + 1;\n                this.removeBlock(uid, isRowExist, removeBlock, child_2, lastchild);\n                args.cachedRowIndex = (removeBlock * this.pageSize);\n            }\n            this.captionRowExpand(args);\n        }\n        else {\n            this.childCount = 0;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.getCurrentBlockEndIndex = function (row, index) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        if (row.isCaptionRow) {\n            if (row.isExpand) {\n                var childCount = this.getChildRowsByParentIndex(index, true).length;\n                this.rowIndex = this.rowIndex + childCount;\n            }\n            var agg = this.getAggregateByCaptionIndex(index);\n            this.rowObjectIndex = this.rowObjectIndex + agg.length;\n            var idx = index;\n            for (var i = idx + 1; i < rows.length; i++) {\n                if (rows[i].indent === rows[index].indent || rows[i].indent < rows[index].indent) {\n                    index = idx;\n                    break;\n                }\n                else {\n                    idx++;\n                }\n            }\n        }\n        return index;\n    };\n    GroupLazyLoadRenderer.prototype.removeBlock = function (uid, isRowExist, removeBlock, child, lastchild) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid1 = child[(((removeBlock + 1) * this.pageSize) - 1) - this.blockSize].uid;\n        var uid2 = child[(removeBlock * this.pageSize) - this.pageSize].uid;\n        var uid3 = child[(removeBlock * this.pageSize)].uid;\n        var firstIdx = this.getRowObjectIndexByUid(uid1);\n        rows[firstIdx].lazyLoadCssClass = 'e-lazyload-middle-up';\n        this.getRowElementByUid(uid1).classList.add('e-lazyload-middle-up');\n        if (lastchild) {\n            this.getRowElementByUid(uid3).classList.add('e-not-lazyload-first');\n            this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-first';\n            this.getRowByUid(uid2).lazyLoadCssClass = '';\n        }\n        if (isRowExist) {\n            this.removeTopRows(lastchild ? lastchild.uid : uid, uid2, uid3);\n        }\n        else {\n            this.uid1 = uid2;\n            this.uid2 = uid3;\n            this.uid3 = lastchild ? lastchild.uid : uid;\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollUpHandler = function (tr) {\n        var page = this.parent.pageSettings.currentPage;\n        var rows = this.groupCache[page];\n        var uid = tr.getAttribute('data-uid');\n        var row = this.getRowByUid(uid);\n        var index = this.rowObjectIndex = this.getRowObjectIndexByUid(uid);\n        var parentCapRow = this.getRowByUid(row.parentUid);\n        var capRowObjIdx = this.rowIndex = this.getRowObjectIndexByUid(parentCapRow.uid);\n        var captionRowEle = this.parent.getRowElementByUID(parentCapRow.uid);\n        var capRowEleIndex = captionRowEle.rowIndex;\n        var child = this.getChildRowsByParentIndex(capRowObjIdx);\n        var childIdx = child.indexOf(rows[index]);\n        var currenBlock = Math.floor((childIdx / this.pageSize));\n        var idx = this.blockSize;\n        if ((this.blockSize * 2) > this.pageSize) {\n            idx = (this.blockSize * 2) - this.pageSize;\n            idx = this.blockSize - idx;\n        }\n        var start = child[(childIdx - (idx - 1)) - this.pageSize].uid;\n        var end = child[childIdx - (idx - 1)].uid;\n        this.scrollData = this.getCacheRowsOnUpScroll(start, end, index - (idx - 1));\n        this.isFirstChildRow = currenBlock > 1;\n        if (this.isFirstChildRow) {\n            this.scrollData[0].lazyLoadCssClass = 'e-not-lazyload-first';\n        }\n        this.getRowByUid(end).lazyLoadCssClass = '';\n        this.getRowElementByUid(end).classList.remove('e-not-lazyload-first');\n        var removeBlock = currenBlock + this.cacheBlockSize;\n        if (child.length !== parentCapRow.data.count && (removeBlock * this.pageSize > child.length)) {\n            this.isFirstChildRow = false;\n            this.scrollData[0].lazyLoadCssClass = '';\n            this.getRowElementByUid(end).classList.add('e-not-lazyload-first');\n            return;\n        }\n        var count = removeBlock * this.pageSize > parentCapRow.data.count\n            ? parentCapRow.data.count : removeBlock * this.pageSize;\n        var size = removeBlock * this.pageSize > parentCapRow.data.count\n            ? (this.pageSize - ((this.pageSize * removeBlock) - parentCapRow.data.count)) : this.pageSize;\n        var childRows = this.getChildRowsByParentIndex(rows.indexOf(child[count - 1]), true, false, null, true);\n        var uid1 = childRows.length ? childRows[childRows.length - 1].uid : child[(count - 1)].uid;\n        var uid2 = child[count - size].uid;\n        var uid3 = child[(count - size) - 1].uid;\n        var lastIdx = this.objIdxByUid[page][uid2] - idx;\n        if (rows[lastIdx].lazyLoadCssClass === 'e-lazyload-middle-down') {\n            var trEle = this.getRowElementByUid(rows[lastIdx].uid);\n            if (trEle) {\n                trEle.classList.add('e-lazyload-middle-down');\n            }\n        }\n        this.getRowByUid(uid1).lazyLoadCssClass = '';\n        this.getRowByUid(uid3).lazyLoadCssClass = 'e-not-lazyload-end';\n        this.getRowElementByUid(uid3).classList.add('e-not-lazyload-end');\n        this.removeBottomRows(uid1, uid2, uid3);\n        this.rowIndex = tr.rowIndex - idx;\n        if (tr.classList.length > 1) {\n            tr.classList.remove('e-lazyload-middle-up');\n        }\n        else {\n            tr.removeAttribute('class');\n        }\n        if (!isNullOrUndefined(this.getRowElementByUid(start))) {\n            this.childCount = 0;\n            this.scrollData = [];\n            return;\n        }\n        var key = getGroupKeysAndFields(this.getRowObjectIndexByUid(parentCapRow.uid), rows);\n        var args = {\n            rowIndex: capRowEleIndex, makeRequest: false, groupInfo: parentCapRow, fields: key.fields,\n            keys: key.keys, skip: this.childCount, take: this.pageSize, isScroll: true, scrollUp: true\n        };\n        this.isScrollUp = true;\n        this.captionRowExpand(args);\n    };\n    GroupLazyLoadRenderer.prototype.findRowElements = function (rows) {\n        var entered = false;\n        var tr;\n        for (var i = 0; i < rows.length; i++) {\n            var rowIdx = rows[i].rowIndex;\n            if (isRowEnteredInGrid(rowIdx, this.parent)) {\n                entered = true;\n                this.rowIndex = rowIdx;\n                tr = rows[i];\n                break;\n            }\n        }\n        return { entered: entered, tr: tr };\n    };\n    GroupLazyLoadRenderer.prototype.getRowElementByUid = function (uid) {\n        return this.parent.getContent().querySelector('tr[data-uid=' + uid + ']');\n    };\n    GroupLazyLoadRenderer.prototype.removeTopRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var start = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid3) {\n                var tr = this.parent.getContent().querySelector('tr[data-uid=' + uid1 + ']');\n                if (tr) {\n                    this.rowIndex = tr.rowIndex;\n                }\n                break;\n            }\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                start = true;\n            }\n            if (start) {\n                remove(trs[i]);\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    GroupLazyLoadRenderer.prototype.removeBottomRows = function (uid1, uid2, uid3) {\n        var trs = [].slice.call(this.parent.getContent().querySelectorAll('tr'));\n        var trigger = false;\n        for (var i = 0; i < trs.length; i++) {\n            if (trs[i].getAttribute('data-uid') === uid2) {\n                trigger = true;\n            }\n            if (trigger) {\n                remove(trs[i]);\n                if (trs[i].getAttribute('data-uid') === uid1) {\n                    break;\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.setCache = function (e) {\n        var page = this.parent.pageSettings.currentPage;\n        this.groupCache[page] = this.initialGroupCaptions[page] = extend([], e.data);\n    };\n    GroupLazyLoadRenderer.prototype.captionRowExpand = function (args) {\n        var _this = this;\n        var captionRow = args.groupInfo;\n        var level = this.parent.groupSettings.columns.indexOf(captionRow.data.field) + 1;\n        var pred = generateExpandPredicates(args.fields, args.keys, this);\n        var predicateList = getPredicates(pred);\n        var lazyLoad = { level: level, skip: args.skip, take: args.take, where: predicateList };\n        if (args.makeRequest) {\n            var query = this.parent.renderModule.data.generateQuery(true);\n            if (!query.isCountRequired) {\n                query.isCountRequired = true;\n            }\n            query.lazyLoad.push({ key: 'onDemandGroupInfo', value: lazyLoad });\n            this.parent.showSpinner();\n            this.parent.renderModule.data.getData({}, query).then(function (e) {\n                _this.parent.hideSpinner();\n                if (e.result.length === 0) {\n                    return;\n                }\n                if (_this.cacheMode && _this.uid1 && _this.uid2) {\n                    _this.removeTopRows(_this.uid3, _this.uid1, _this.uid2);\n                    _this.uid1 = _this.uid2 = _this.uid3 = undefined;\n                }\n                _this.lazyLoadHandler({\n                    data: e.result, count: e.count, level: level, index: args.rowIndex,\n                    isRowExist: false, isScroll: args.isScroll, up: false, rowIndex: args.cachedRowIndex\n                });\n            })\n                .catch(function (e) { return _this.parent.renderModule.dataManagerFailure(e, { requestType: 'grouping' }); });\n        }\n        else {\n            this.lazyLoadHandler({\n                data: null, count: args.groupInfo.data.count, level: level, index: args.rowIndex,\n                isRowExist: true, isScroll: args.isScroll, up: args.scrollUp, rowIndex: args.cachedRowIndex\n            });\n        }\n    };\n    GroupLazyLoadRenderer.prototype.scrollReset = function (top) {\n        this.parent.getContent().firstElementChild.scrollTop = top ? this.parent.getContent().firstElementChild.scrollTop + top : 0;\n    };\n    GroupLazyLoadRenderer.prototype.updateCurrentViewData = function () {\n        var records = [];\n        this.getRows().filter(function (row) {\n            if (row.isDataRow) {\n                records[row.index] = row.data;\n            }\n        });\n        this.parent.currentViewData = records.length ? records : this.parent.currentViewData;\n    };\n    /**\n     * @returns {Row<Column>[]} returns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getGroupCache = function () {\n        return this.groupCache;\n    };\n    /**\n     * @returns {Row<Column>[]} returns the row\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRows = function () {\n        return this.groupCache[this.parent.pageSettings.currentPage] || [];\n    };\n    /**\n     * @returns {Element} returns the element\n     * @hidden */\n    GroupLazyLoadRenderer.prototype.getRowElements = function () {\n        return [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n    };\n    /**\n     * @param {number} index - specifies the index\n     * @returns {Element} returns the element\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.getRowByIndex = function (index) {\n        var tr = [].slice.call(this.parent.getContent().getElementsByClassName(literals.row));\n        var row;\n        for (var i = 0; !isNullOrUndefined(index) && i < tr.length; i++) {\n            if (tr[i].getAttribute(literals.ariaRowIndex) === index.toString()) {\n                row = tr[i];\n                break;\n            }\n        }\n        return row;\n    };\n    /**\n     * Tucntion to set the column visibility\n     *\n     * @param {Column[]} columns - specifies the column\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.setVisible = function (columns) {\n        var gObj = this.parent;\n        var rows = this.getRows();\n        var testRow;\n        rows.some(function (r) { if (r.isDataRow) {\n            testRow = r;\n        } return r.isDataRow; });\n        var contentrows = this.getRows().filter(function (row) { return !row.isDetailRow; });\n        for (var i = 0; i < columns.length; i++) {\n            var column = columns[i];\n            var idx = this.parent.getNormalizedColumnIndex(column.uid);\n            var colIdx = this.parent.getColumnIndexByUid(column.uid);\n            var displayVal = column.visible === true ? '' : 'none';\n            if (idx !== -1 && testRow && idx < testRow.cells.length) {\n                setStyleAttribute(this.getColGroup().childNodes[idx], { 'display': displayVal });\n            }\n            this.setDisplayNone(gObj.getDataRows(), colIdx, displayVal, contentrows, idx);\n            if (!this.parent.invokedFromMedia && column.hideAtMedia) {\n                this.parent.updateMediaColumns(column);\n            }\n            this.parent.invokedFromMedia = false;\n        }\n    };\n    /**\n     * Function to set display.\n     *\n     * @param {Object} tr - specifies the row object\n     * @param {number} idx - specifies the index\n     * @param {string} displayVal - specifies the display value\n     * @param {Row<Column>[]} rows - specifies the array of rows\n     * @param {number} oriIdx - specifies the index\n     * @returns {void}\n     * @hidden\n     */\n    GroupLazyLoadRenderer.prototype.setDisplayNone = function (tr, idx, displayVal, rows, oriIdx) {\n        if (!this.parent.groupSettings.columns.length) {\n            setDisplayValue(tr, idx, displayVal, rows);\n        }\n        else {\n            var keys = Object.keys(this.groupCache);\n            for (var j = 0; j < keys.length; j++) {\n                var uids = this.rowsByUid[keys[j]];\n                var idxs = Object.keys(uids);\n                for (var i = 0; i < idxs.length; i++) {\n                    var tr_1 = this.parent.getContent().querySelector('tr[data-uid=' + idxs[i] + ']');\n                    var row = uids[idxs[i]];\n                    if (row.isCaptionRow) {\n                        if (!this.captionModelGen.isEmpty()) {\n                            this.changeCaptionRow(row, tr_1, keys[j]);\n                        }\n                        else {\n                            row.cells[row.indent + 1].colSpan = displayVal === '' ? row.cells[row.indent + 1].colSpan + 1\n                                : row.cells[row.indent + 1].colSpan - 1;\n                            if (tr_1) {\n                                tr_1.cells[row.indent + 1].colSpan = row.cells[row.indent + 1].colSpan;\n                            }\n                        }\n                    }\n                    if (row.isDataRow) {\n                        this.showAndHideCells(tr_1, idx, displayVal, false);\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                    }\n                    if (!row.isCaptionRow && !row.isDataRow && isNullOrUndefined(row.indent)) {\n                        row.cells[oriIdx].visible = displayVal === '' ? true : false;\n                        row.visible = row.cells.some(function (cell) { return cell.isDataCell && cell.visible; });\n                        this.showAndHideCells(tr_1, idx, displayVal, true, row);\n                    }\n                }\n            }\n        }\n    };\n    GroupLazyLoadRenderer.prototype.changeCaptionRow = function (row, tr, index) {\n        var capRow = row;\n        var captionData = row.data;\n        var data = this.groupGenerator.generateCaptionRow(captionData, capRow.indent, capRow.parentGid, undefined, capRow.tIndex, capRow.parentUid);\n        data.uid = row.uid;\n        data.isExpand = row.isExpand;\n        data.lazyLoadCssClass = row.lazyLoadCssClass;\n        this.rowsByUid[index][row.uid] = data;\n        this.groupCache[index][this.objIdxByUid[index][row.uid]] = data;\n        if (tr) {\n            var tbody = this.parent.getContentTable().querySelector(literals.tbody);\n            tbody.replaceChild(this.rowRenderer.render(data, this.parent.getColumns()), tr);\n        }\n    };\n    GroupLazyLoadRenderer.prototype.showAndHideCells = function (tr, idx, displayVal, isSummary, row) {\n        if (tr) {\n            var cls = isSummary ? 'td.e-summarycell' : 'td.e-rowcell';\n            setStyleAttribute(tr.querySelectorAll(cls)[idx], { 'display': displayVal });\n            if (tr.querySelectorAll(cls)[idx].classList.contains('e-hide')) {\n                removeClass([tr.querySelectorAll(cls)[idx]], ['e-hide']);\n            }\n            if (isSummary) {\n                if (row.visible && tr.classList.contains('e-hide')) {\n                    removeClass([tr], ['e-hide']);\n                }\n                else if (!row.visible) {\n                    addClass([tr], ['e-hide']);\n                }\n            }\n        }\n    };\n    return GroupLazyLoadRenderer;\n}(ContentRender));\nexport { GroupLazyLoadRenderer };\n"]},"metadata":{},"sourceType":"module"}