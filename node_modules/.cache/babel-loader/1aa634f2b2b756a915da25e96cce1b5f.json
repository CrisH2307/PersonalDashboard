{"ast":null,"code":"import { detach, getUniqueID, append, closest, selectAll, select, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Browser, isNullOrUndefined, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isCollide } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, isIDevice } from '../base/util';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ColorPickerInput } from './color-picker';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\n\nvar BaseQuickToolbar =\n/** @class */\nfunction () {\n  function BaseQuickToolbar(parent, locator) {\n    this.parent = parent;\n    this.locator = locator;\n    this.isDOMElement = false;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n    this.popupRenderer = this.renderFactory.getRenderer(RenderType.Popup);\n    this.dropDownButtons = new DropDownButtons(this.parent, this.locator);\n    this.colorPickerObj = new ColorPickerInput(this.parent, this.locator);\n  }\n\n  BaseQuickToolbar.prototype.appendPopupContent = function () {\n    this.toolbarElement = this.parent.createElement('div', {\n      className: classes.CLS_QUICK_TB\n    });\n    this.element.appendChild(this.toolbarElement);\n  };\n  /**\n   * render method\n   *\n   * @param {IQuickToolbarOptions} args - specifies the arguments\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.render = function (args) {\n    var className;\n\n    if (args.popupType === 'Image') {\n      className = classes.CLS_IMAGE_POP;\n    } else if (args.popupType === 'Inline') {\n      className = classes.CLS_INLINE_POP;\n    } else {\n      className = '';\n    }\n\n    var popupId = getUniqueID(args.popupType + '_Quick_Popup');\n    this.stringItems = args.toolbarItems;\n    this.element = this.parent.createElement('div', {\n      id: popupId,\n      className: className + ' ' + classes.CLS_RTE_ELEMENTS\n    });\n    this.element.setAttribute('aria-owns', this.parent.getID());\n    this.appendPopupContent();\n    this.createToolbar(args.toolbarItems, args.mode);\n    this.popupRenderer.renderPopup(this);\n    this.addEventListener();\n  };\n\n  BaseQuickToolbar.prototype.createToolbar = function (items, mode) {\n    this.quickTBarObj = new BaseToolbar(this.parent, this.locator);\n    this.quickTBarObj.render({\n      container: 'quick',\n      target: this.toolbarElement,\n      items: items,\n      mode: mode\n    });\n    this.quickTBarObj.toolbarObj.refresh();\n  };\n\n  BaseQuickToolbar.prototype.setPosition = function (e) {\n    var x;\n    var y;\n    var imgWrapper = closest(e.target, '.e-img-caption');\n    var target = !isNOU(imgWrapper) ? imgWrapper : e.target;\n    addClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n    var targetOffsetTop = target.offsetTop;\n    var parentOffsetTop = window.pageYOffset + e.parentData.top;\n\n    if (targetOffsetTop - e.editTop > e.popHeight) {\n      y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) - e.popHeight - 5;\n    } else if (e.editTop + e.editHeight - (targetOffsetTop + target.offsetHeight) > e.popHeight) {\n      y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) + target.offsetHeight + 5;\n    } else {\n      y = e.y;\n    }\n\n    if (target.offsetWidth > e.popWidth) {\n      x = target.offsetWidth / 2 - e.popWidth / 2 + e.parentData.left + target.offsetLeft;\n    } else {\n      x = e.parentData.left + target.offsetLeft;\n    }\n\n    this.popupObj.position.X = x + e.popWidth > e.parentData.right ? e.parentData.right - e.popWidth : x;\n    this.popupObj.position.Y = y >= 0 ? y : e.y + 5;\n    this.popupObj.dataBind();\n    removeClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n  };\n\n  BaseQuickToolbar.prototype.checkCollision = function (e, viewPort, type) {\n    var x;\n    var y;\n    var parentTop = e.parentData.top;\n    var contentTop = e.windowY + parentTop + e.tBarElementHeight;\n    var collision = [];\n\n    if (viewPort === 'document') {\n      collision = isCollide(e.popup);\n    } else {\n      collision = isCollide(e.popup, e.parentElement);\n    }\n\n    for (var i = 0; i < collision.length; i++) {\n      switch (collision[i]) {\n        case 'top':\n          if (viewPort === 'document') {\n            y = e.windowY;\n          } else {\n            y = window.pageYOffset + parentTop + e.tBarElementHeight;\n          }\n\n          break;\n\n        case 'bottom':\n          {\n            var posY = void 0;\n\n            if (viewPort === 'document') {\n              if (type === 'inline') {\n                posY = e.y - e.popHeight - 10;\n              } else {\n                if (e.windowHeight - (parentTop + e.tBarElementHeight) > e.popHeight) {\n                  if (contentTop - e.windowHeight > e.popHeight) {\n                    posY = contentTop + (e.windowHeight - parentTop) - e.popHeight;\n                  } else {\n                    posY = contentTop;\n                  }\n                } else {\n                  posY = e.windowY + (parentTop + e.tBarElementHeight);\n                }\n              }\n            } else {\n              if (e.target.tagName !== 'IMG') {\n                posY = e.parentData.bottom + window.pageYOffset - e.popHeight - 10;\n              } else {\n                posY = e.parentData.bottom + window.pageYOffset - e.popHeight - 5;\n              }\n            }\n\n            y = posY;\n            break;\n          }\n\n        case 'right':\n          if (type === 'inline') {\n            x = window.pageXOffset + (e.windowWidth - (e.popWidth + e.bodyRightSpace + 10));\n          } else {\n            x = e.x - e.popWidth;\n          }\n\n          break;\n\n        case 'left':\n          if (type === 'inline') {\n            x = 0;\n          } else {\n            x = e.parentData.left;\n          }\n\n          break;\n      }\n    }\n\n    this.popupObj.position.X = x ? x : this.popupObj.position.X;\n    this.popupObj.position.Y = y ? y : this.popupObj.position.Y;\n    this.popupObj.dataBind();\n  };\n  /**\n   * showPopup method\n   *\n   * @param {number} x - specifies the x value\n   * @param {number} y - specifies the y value\n   * @param {Element} target - specifies the element\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.showPopup = function (x, y, target) {\n    var _this = this;\n\n    var eventArgs = {\n      popup: this.popupObj,\n      cancel: false,\n      targetElement: target\n    };\n    this.parent.trigger(events.beforeQuickToolbarOpen, eventArgs, function (beforeQuickToolbarArgs) {\n      if (!beforeQuickToolbarArgs.cancel) {\n        var editPanelTop = void 0;\n        var editPanelHeight = void 0;\n        var bodyStyle = window.getComputedStyle(document.body);\n        var bodyRight = parseFloat(bodyStyle.marginRight.split('px')[0]) + parseFloat(bodyStyle.paddingRight.split('px')[0]);\n        var windowHeight = window.innerHeight;\n        var windowWidth = window.innerWidth;\n        var parent_1 = _this.parent.element;\n        var toolbarAvail = !isNullOrUndefined(_this.parent.getToolbar());\n\n        var tbHeight = toolbarAvail && _this.parent.toolbarModule.getToolbarHeight();\n\n        var expTBHeight = toolbarAvail && _this.parent.toolbarModule.getExpandTBarPopHeight();\n\n        var tBarHeight = toolbarAvail ? tbHeight + expTBHeight : 0;\n        addClass([_this.element], [classes.CLS_HIDE]);\n\n        if (Browser.isDevice && !isIDevice()) {\n          addClass([_this.parent.getToolbar()], [classes.CLS_HIDE]);\n        }\n\n        if (_this.parent.iframeSettings.enable) {\n          var cntEle = _this.contentRenderer.getPanel().contentWindow;\n\n          editPanelTop = cntEle.pageYOffset;\n          editPanelHeight = cntEle.innerHeight;\n        } else {\n          var cntEle = closest(target, '.' + classes.CLS_RTE_CONTENT);\n          editPanelTop = cntEle ? cntEle.scrollTop : 0;\n          editPanelHeight = cntEle ? cntEle.offsetHeight : 0;\n        }\n\n        if (!_this.parent.inlineMode.enable && !closest(target, 'table')) {\n          _this.parent.disableToolbarItem(_this.parent.toolbarSettings.items);\n\n          _this.parent.enableToolbarItem(['Undo', 'Redo']);\n        }\n\n        append([_this.element], document.body);\n        _this.popupObj.position.X = x + 20;\n        _this.popupObj.position.Y = y + 20;\n\n        _this.popupObj.dataBind();\n\n        _this.popupObj.element.classList.add('e-popup-open');\n\n        _this.dropDownButtons.renderDropDowns({\n          container: _this.toolbarElement,\n          containerType: 'quick',\n          items: _this.stringItems\n        });\n\n        _this.colorPickerObj.renderColorPickerInput({\n          container: _this.toolbarElement,\n          containerType: 'quick',\n          items: _this.stringItems\n        });\n\n        var showPopupData = {\n          x: x,\n          y: y,\n          target: target,\n          editTop: editPanelTop,\n          editHeight: editPanelHeight,\n          popup: _this.popupObj.element,\n          popHeight: _this.popupObj.element.offsetHeight,\n          popWidth: _this.popupObj.element.offsetWidth,\n          parentElement: parent_1,\n          bodyRightSpace: bodyRight,\n          windowY: window.pageYOffset,\n          windowHeight: windowHeight,\n          windowWidth: windowWidth,\n          parentData: parent_1.getBoundingClientRect(),\n          tBarElementHeight: tBarHeight\n        };\n\n        if (target.tagName === 'IMG') {\n          _this.setPosition(showPopupData);\n        }\n\n        if (!_this.parent.inlineMode.enable) {\n          _this.checkCollision(showPopupData, 'parent', '');\n        }\n\n        _this.checkCollision(showPopupData, 'document', _this.parent.inlineMode.enable ? 'inline' : '');\n\n        _this.popupObj.element.classList.remove('e-popup-open');\n\n        removeClass([_this.element], [classes.CLS_HIDE]);\n\n        _this.popupObj.show({\n          name: 'ZoomIn',\n          duration: Browser.isIE ? 250 : 400\n        });\n\n        setStyleAttribute(_this.element, {\n          maxWidth: window.outerWidth + 'px'\n        });\n        addClass([_this.element], [classes.CLS_POP]);\n        _this.isDOMElement = true;\n      }\n    });\n  };\n  /**\n   * hidePopup method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.hidePopup = function () {\n    var viewSourcePanel = this.parent.sourceCodeModule.getViewPanel();\n\n    if (Browser.isDevice && !isIDevice()) {\n      removeClass([this.parent.getToolbar()], [classes.CLS_HIDE]);\n    }\n\n    if (!isNullOrUndefined(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n      if (isNullOrUndefined(viewSourcePanel) || viewSourcePanel.style.display === 'none') {\n        this.parent.enableToolbarItem(this.parent.toolbarSettings.items);\n      }\n    }\n\n    this.removeEleFromDOM();\n    this.isDOMElement = false;\n  };\n  /**\n   * @param {string} item - specifies the string value\n   * @param {number} index - specifies the index value\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.addQTBarItem = function (item, index) {\n    this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(item, 'toolbar'), index);\n  };\n  /**\n   * @param {number} index - specifies the index value\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.removeQTBarItem = function (index) {\n    this.quickTBarObj.toolbarObj.removeItems(index);\n  };\n\n  BaseQuickToolbar.prototype.removeEleFromDOM = function () {\n    var element = this.popupObj.element;\n\n    if (this.isDOMElement) {\n      this.dropDownButtons.destroyDropDowns();\n      this.colorPickerObj.destroyColorPicker();\n      removeClass([this.element], [classes.CLS_POP]);\n      detach(element);\n      var args = this.popupObj;\n      this.parent.trigger(events.quickToolbarClose, args);\n    }\n  };\n\n  BaseQuickToolbar.prototype.updateStatus = function (args) {\n    var options = {\n      args: args,\n      dropDownModule: this.dropDownButtons,\n      parent: this.parent,\n      tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.element),\n      tbItems: this.quickTBarObj.toolbarObj.items\n    };\n    setToolbarStatus(options, true, this.parent);\n\n    if (!select('.e-rte-srctextarea', this.parent.element)) {\n      updateUndoRedoStatus(this.parent.getBaseToolbarObject(), this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n    }\n  };\n  /**\n   * Destroys the Quick toolbar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.destroy = function () {\n    if (this.popupObj && !this.popupObj.isDestroyed) {\n      this.popupObj.destroy();\n      this.removeEleFromDOM();\n    }\n\n    this.removeEventListener();\n  };\n  /**\n   * addEventListener method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n\n    if (this.parent.inlineMode.enable) {\n      this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n    }\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the model element\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.onPropertyChanged = function (e) {\n    if (!isNullOrUndefined(e.newProp.inlineMode)) {\n      for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n        var prop = _a[_i];\n\n        switch (prop) {\n          case 'enable':\n            if (e.newProp.inlineMode.enable) {\n              this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n            } else {\n              this.parent.off(events.toolbarUpdated, this.updateStatus);\n            }\n\n            break;\n        }\n      }\n    }\n  };\n  /**\n   * removeEventListener method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  BaseQuickToolbar.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n\n    if (this.parent.inlineMode.enable) {\n      this.parent.off(events.toolbarUpdated, this.updateStatus);\n    }\n  };\n\n  return BaseQuickToolbar;\n}();\n\nexport { BaseQuickToolbar };","map":{"version":3,"sources":["C:/Users/khang/OneDrive/Tài liệu/JS/PersonalDashdoard/dashboard/node_modules/@syncfusion/ej2-react-richtexteditor/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/base-quick-toolbar.js"],"names":["detach","getUniqueID","append","closest","selectAll","select","isNullOrUndefined","isNOU","addClass","removeClass","Browser","setStyleAttribute","isCollide","events","classes","RenderType","setToolbarStatus","updateUndoRedoStatus","isIDevice","BaseToolbar","DropDownButtons","ColorPickerInput","BaseQuickToolbar","parent","locator","isDOMElement","renderFactory","getService","contentRenderer","getRenderer","Content","popupRenderer","Popup","dropDownButtons","colorPickerObj","prototype","appendPopupContent","toolbarElement","createElement","className","CLS_QUICK_TB","element","appendChild","render","args","popupType","CLS_IMAGE_POP","CLS_INLINE_POP","popupId","stringItems","toolbarItems","id","CLS_RTE_ELEMENTS","setAttribute","getID","createToolbar","mode","renderPopup","addEventListener","items","quickTBarObj","container","target","toolbarObj","refresh","setPosition","e","x","y","imgWrapper","CLS_RM_WHITE_SPACE","targetOffsetTop","offsetTop","parentOffsetTop","window","pageYOffset","parentData","top","editTop","popHeight","tBarElementHeight","editHeight","offsetHeight","offsetWidth","popWidth","left","offsetLeft","popupObj","position","X","right","Y","dataBind","checkCollision","viewPort","type","parentTop","contentTop","windowY","collision","popup","parentElement","i","length","posY","windowHeight","tagName","bottom","pageXOffset","windowWidth","bodyRightSpace","showPopup","_this","eventArgs","cancel","targetElement","trigger","beforeQuickToolbarOpen","beforeQuickToolbarArgs","editPanelTop","editPanelHeight","bodyStyle","getComputedStyle","document","body","bodyRight","parseFloat","marginRight","split","paddingRight","innerHeight","innerWidth","parent_1","toolbarAvail","getToolbar","tbHeight","toolbarModule","getToolbarHeight","expTBHeight","getExpandTBarPopHeight","tBarHeight","CLS_HIDE","isDevice","iframeSettings","enable","cntEle","getPanel","contentWindow","CLS_RTE_CONTENT","scrollTop","inlineMode","disableToolbarItem","toolbarSettings","enableToolbarItem","classList","add","renderDropDowns","containerType","renderColorPickerInput","showPopupData","getBoundingClientRect","remove","show","name","duration","isIE","maxWidth","outerWidth","CLS_POP","hidePopup","viewSourcePanel","sourceCodeModule","getViewPanel","style","display","removeEleFromDOM","addQTBarItem","item","index","addItems","getItems","removeQTBarItem","removeItems","destroyDropDowns","destroyColorPicker","quickToolbarClose","updateStatus","options","dropDownModule","tbElements","CLS_TB_ITEM","tbItems","getBaseToolbarObject","formatter","editorManager","undoRedoManager","getUndoStatus","destroy","isDestroyed","removeEventListener","on","modelChanged","onPropertyChanged","toolbarUpdated","newProp","_i","_a","Object","keys","prop","off"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,WAAjB,EAA8BC,MAA9B,EAAsCC,OAAtC,EAA+CC,SAA/C,EAA0DC,MAA1D,EAAkEC,iBAAiB,IAAIC,KAAvF,QAAoG,sBAApG;AACA,SAASC,QAAT,EAAmBC,WAAnB,EAAgCC,OAAhC,EAAyCJ,iBAAzC,EAA4DK,iBAA5D,QAAqF,sBAArF;AACA,SAASC,SAAT,QAA0B,wBAA1B;AACA,OAAO,KAAKC,MAAZ,MAAwB,kBAAxB;AACA,OAAO,KAAKC,OAAZ,MAAyB,iBAAzB;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,SAASC,gBAAT,EAA2BC,oBAA3B,EAAiDC,SAAjD,QAAkE,cAAlE;AACA,SAASC,WAAT,QAA4B,gBAA5B;AACA,SAASC,eAAT,QAAgC,oBAAhC;AACA,SAASC,gBAAT,QAAiC,gBAAjC;AACA;AACA;AACA;;AACA,IAAIC,gBAAgB;AAAG;AAAe,YAAY;AAC9C,WAASA,gBAAT,CAA0BC,MAA1B,EAAkCC,OAAlC,EAA2C;AACvC,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKC,OAAL,GAAeA,OAAf;AACA,SAAKC,YAAL,GAAoB,KAApB;AACA,SAAKC,aAAL,GAAqB,KAAKF,OAAL,CAAaG,UAAb,CAAwB,iBAAxB,CAArB;AACA,SAAKC,eAAL,GAAuB,KAAKF,aAAL,CAAmBG,WAAnB,CAA+Bd,UAAU,CAACe,OAA1C,CAAvB;AACA,SAAKC,aAAL,GAAqB,KAAKL,aAAL,CAAmBG,WAAnB,CAA+Bd,UAAU,CAACiB,KAA1C,CAArB;AACA,SAAKC,eAAL,GAAuB,IAAIb,eAAJ,CAAoB,KAAKG,MAAzB,EAAiC,KAAKC,OAAtC,CAAvB;AACA,SAAKU,cAAL,GAAsB,IAAIb,gBAAJ,CAAqB,KAAKE,MAA1B,EAAkC,KAAKC,OAAvC,CAAtB;AACH;;AACDF,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BC,kBAA3B,GAAgD,YAAY;AACxD,SAAKC,cAAL,GAAsB,KAAKd,MAAL,CAAYe,aAAZ,CAA0B,KAA1B,EAAiC;AAAEC,MAAAA,SAAS,EAAEzB,OAAO,CAAC0B;AAArB,KAAjC,CAAtB;AACA,SAAKC,OAAL,CAAaC,WAAb,CAAyB,KAAKL,cAA9B;AACH,GAHD;AAIA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEIf,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BQ,MAA3B,GAAoC,UAAUC,IAAV,EAAgB;AAChD,QAAIL,SAAJ;;AACA,QAAIK,IAAI,CAACC,SAAL,KAAmB,OAAvB,EAAgC;AAC5BN,MAAAA,SAAS,GAAGzB,OAAO,CAACgC,aAApB;AACH,KAFD,MAGK,IAAIF,IAAI,CAACC,SAAL,KAAmB,QAAvB,EAAiC;AAClCN,MAAAA,SAAS,GAAGzB,OAAO,CAACiC,cAApB;AACH,KAFI,MAGA;AACDR,MAAAA,SAAS,GAAG,EAAZ;AACH;;AACD,QAAIS,OAAO,GAAG/C,WAAW,CAAC2C,IAAI,CAACC,SAAL,GAAiB,cAAlB,CAAzB;AACA,SAAKI,WAAL,GAAmBL,IAAI,CAACM,YAAxB;AACA,SAAKT,OAAL,GAAe,KAAKlB,MAAL,CAAYe,aAAZ,CAA0B,KAA1B,EAAiC;AAAEa,MAAAA,EAAE,EAAEH,OAAN;AAAeT,MAAAA,SAAS,EAAEA,SAAS,GAAG,GAAZ,GAAkBzB,OAAO,CAACsC;AAApD,KAAjC,CAAf;AACA,SAAKX,OAAL,CAAaY,YAAb,CAA0B,WAA1B,EAAuC,KAAK9B,MAAL,CAAY+B,KAAZ,EAAvC;AACA,SAAKlB,kBAAL;AACA,SAAKmB,aAAL,CAAmBX,IAAI,CAACM,YAAxB,EAAsCN,IAAI,CAACY,IAA3C;AACA,SAAKzB,aAAL,CAAmB0B,WAAnB,CAA+B,IAA/B;AACA,SAAKC,gBAAL;AACH,GAnBD;;AAoBApC,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BoB,aAA3B,GAA2C,UAAUI,KAAV,EAAiBH,IAAjB,EAAuB;AAC9D,SAAKI,YAAL,GAAoB,IAAIzC,WAAJ,CAAgB,KAAKI,MAArB,EAA6B,KAAKC,OAAlC,CAApB;AACA,SAAKoC,YAAL,CAAkBjB,MAAlB,CAAyB;AACrBkB,MAAAA,SAAS,EAAE,OADU;AAErBC,MAAAA,MAAM,EAAE,KAAKzB,cAFQ;AAGrBsB,MAAAA,KAAK,EAAEA,KAHc;AAIrBH,MAAAA,IAAI,EAAEA;AAJe,KAAzB;AAMA,SAAKI,YAAL,CAAkBG,UAAlB,CAA6BC,OAA7B;AACH,GATD;;AAUA1C,EAAAA,gBAAgB,CAACa,SAAjB,CAA2B8B,WAA3B,GAAyC,UAAUC,CAAV,EAAa;AAClD,QAAIC,CAAJ;AACA,QAAIC,CAAJ;AACA,QAAIC,UAAU,GAAGlE,OAAO,CAAC+D,CAAC,CAACJ,MAAH,EAAW,gBAAX,CAAxB;AACA,QAAIA,MAAM,GAAG,CAACvD,KAAK,CAAC8D,UAAD,CAAN,GAAqBA,UAArB,GAAkCH,CAAC,CAACJ,MAAjD;AACAtD,IAAAA,QAAQ,CAAC,CAAC,KAAK6B,cAAN,CAAD,EAAwB,CAACvB,OAAO,CAACwD,kBAAT,CAAxB,CAAR;AACA,QAAIC,eAAe,GAAGT,MAAM,CAACU,SAA7B;AACA,QAAIC,eAAe,GAAGC,MAAM,CAACC,WAAP,GAAqBT,CAAC,CAACU,UAAF,CAAaC,GAAxD;;AACA,QAAKN,eAAe,GAAGL,CAAC,CAACY,OAArB,GAAgCZ,CAAC,CAACa,SAAtC,EAAiD;AAC7CX,MAAAA,CAAC,GAAGK,eAAe,GAAGP,CAAC,CAACc,iBAApB,IAAyCT,eAAe,GAAGL,CAAC,CAACY,OAA7D,IAAwEZ,CAAC,CAACa,SAA1E,GAAsF,CAA1F;AACH,KAFD,MAGK,IAAMb,CAAC,CAACY,OAAF,GAAYZ,CAAC,CAACe,UAAf,IAA8BV,eAAe,GAAGT,MAAM,CAACoB,YAAvD,CAAD,GAAyEhB,CAAC,CAACa,SAA/E,EAA0F;AAC3FX,MAAAA,CAAC,GAAGK,eAAe,GAAGP,CAAC,CAACc,iBAApB,IAAyCT,eAAe,GAAGL,CAAC,CAACY,OAA7D,IAAwEhB,MAAM,CAACoB,YAA/E,GAA8F,CAAlG;AACH,KAFI,MAGA;AACDd,MAAAA,CAAC,GAAGF,CAAC,CAACE,CAAN;AACH;;AACD,QAAIN,MAAM,CAACqB,WAAP,GAAqBjB,CAAC,CAACkB,QAA3B,EAAqC;AACjCjB,MAAAA,CAAC,GAAIL,MAAM,CAACqB,WAAP,GAAqB,CAAtB,GAA4BjB,CAAC,CAACkB,QAAF,GAAa,CAAzC,GAA8ClB,CAAC,CAACU,UAAF,CAAaS,IAA3D,GAAkEvB,MAAM,CAACwB,UAA7E;AACH,KAFD,MAGK;AACDnB,MAAAA,CAAC,GAAGD,CAAC,CAACU,UAAF,CAAaS,IAAb,GAAoBvB,MAAM,CAACwB,UAA/B;AACH;;AACD,SAAKC,QAAL,CAAcC,QAAd,CAAuBC,CAAvB,GAA6BtB,CAAC,GAAGD,CAAC,CAACkB,QAAP,GAAmBlB,CAAC,CAACU,UAAF,CAAac,KAAjC,GAA0CxB,CAAC,CAACU,UAAF,CAAac,KAAb,GAAqBxB,CAAC,CAACkB,QAAjE,GAA4EjB,CAAvG;AACA,SAAKoB,QAAL,CAAcC,QAAd,CAAuBG,CAAvB,GAA4BvB,CAAC,IAAI,CAAN,GAAWA,CAAX,GAAeF,CAAC,CAACE,CAAF,GAAM,CAAhD;AACA,SAAKmB,QAAL,CAAcK,QAAd;AACAnF,IAAAA,WAAW,CAAC,CAAC,KAAK4B,cAAN,CAAD,EAAwB,CAACvB,OAAO,CAACwD,kBAAT,CAAxB,CAAX;AACH,GA3BD;;AA4BAhD,EAAAA,gBAAgB,CAACa,SAAjB,CAA2B0D,cAA3B,GAA4C,UAAU3B,CAAV,EAAa4B,QAAb,EAAuBC,IAAvB,EAA6B;AACrE,QAAI5B,CAAJ;AACA,QAAIC,CAAJ;AACA,QAAI4B,SAAS,GAAG9B,CAAC,CAACU,UAAF,CAAaC,GAA7B;AACA,QAAIoB,UAAU,GAAG/B,CAAC,CAACgC,OAAF,GAAYF,SAAZ,GAAwB9B,CAAC,CAACc,iBAA3C;AACA,QAAImB,SAAS,GAAG,EAAhB;;AACA,QAAIL,QAAQ,KAAK,UAAjB,EAA6B;AACzBK,MAAAA,SAAS,GAAGvF,SAAS,CAACsD,CAAC,CAACkC,KAAH,CAArB;AACH,KAFD,MAGK;AACDD,MAAAA,SAAS,GAAGvF,SAAS,CAACsD,CAAC,CAACkC,KAAH,EAAUlC,CAAC,CAACmC,aAAZ,CAArB;AACH;;AACD,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,SAAS,CAACI,MAA9B,EAAsCD,CAAC,EAAvC,EAA2C;AACvC,cAAQH,SAAS,CAACG,CAAD,CAAjB;AACI,aAAK,KAAL;AACI,cAAIR,QAAQ,KAAK,UAAjB,EAA6B;AACzB1B,YAAAA,CAAC,GAAGF,CAAC,CAACgC,OAAN;AACH,WAFD,MAGK;AACD9B,YAAAA,CAAC,GAAIM,MAAM,CAACC,WAAP,GAAqBqB,SAAtB,GAAmC9B,CAAC,CAACc,iBAAzC;AACH;;AACD;;AACJ,aAAK,QAAL;AAAe;AACX,gBAAIwB,IAAI,GAAG,KAAK,CAAhB;;AACA,gBAAIV,QAAQ,KAAK,UAAjB,EAA6B;AACzB,kBAAIC,IAAI,KAAK,QAAb,EAAuB;AACnBS,gBAAAA,IAAI,GAAItC,CAAC,CAACE,CAAF,GAAMF,CAAC,CAACa,SAAR,GAAoB,EAA5B;AACH,eAFD,MAGK;AACD,oBAAKb,CAAC,CAACuC,YAAF,IAAkBT,SAAS,GAAG9B,CAAC,CAACc,iBAAhC,CAAD,GAAuDd,CAAC,CAACa,SAA7D,EAAwE;AACpE,sBAAKkB,UAAU,GAAG/B,CAAC,CAACuC,YAAhB,GAAgCvC,CAAC,CAACa,SAAtC,EAAiD;AAC7CyB,oBAAAA,IAAI,GAAIP,UAAU,IAAI/B,CAAC,CAACuC,YAAF,GAAiBT,SAArB,CAAX,GAA8C9B,CAAC,CAACa,SAAvD;AACH,mBAFD,MAGK;AACDyB,oBAAAA,IAAI,GAAGP,UAAP;AACH;AACJ,iBAPD,MAQK;AACDO,kBAAAA,IAAI,GAAGtC,CAAC,CAACgC,OAAF,IAAaF,SAAS,GAAG9B,CAAC,CAACc,iBAA3B,CAAP;AACH;AACJ;AACJ,aAjBD,MAkBK;AACD,kBAAId,CAAC,CAACJ,MAAF,CAAS4C,OAAT,KAAqB,KAAzB,EAAgC;AAC5BF,gBAAAA,IAAI,GAAItC,CAAC,CAACU,UAAF,CAAa+B,MAAb,GAAsBjC,MAAM,CAACC,WAA9B,GAA6CT,CAAC,CAACa,SAA/C,GAA2D,EAAlE;AACH,eAFD,MAGK;AACDyB,gBAAAA,IAAI,GAAItC,CAAC,CAACU,UAAF,CAAa+B,MAAb,GAAsBjC,MAAM,CAACC,WAA9B,GAA6CT,CAAC,CAACa,SAA/C,GAA2D,CAAlE;AACH;AACJ;;AACDX,YAAAA,CAAC,GAAGoC,IAAJ;AACA;AACH;;AACD,aAAK,OAAL;AACI,cAAIT,IAAI,KAAK,QAAb,EAAuB;AACnB5B,YAAAA,CAAC,GAAGO,MAAM,CAACkC,WAAP,IAAsB1C,CAAC,CAAC2C,WAAF,IAAiB3C,CAAC,CAACkB,QAAF,GAAalB,CAAC,CAAC4C,cAAf,GAAgC,EAAjD,CAAtB,CAAJ;AACH,WAFD,MAGK;AACD3C,YAAAA,CAAC,GAAGD,CAAC,CAACC,CAAF,GAAMD,CAAC,CAACkB,QAAZ;AACH;;AACD;;AACJ,aAAK,MAAL;AACI,cAAIW,IAAI,KAAK,QAAb,EAAuB;AACnB5B,YAAAA,CAAC,GAAG,CAAJ;AACH,WAFD,MAGK;AACDA,YAAAA,CAAC,GAAGD,CAAC,CAACU,UAAF,CAAaS,IAAjB;AACH;;AACD;AAvDR;AAyDH;;AACD,SAAKE,QAAL,CAAcC,QAAd,CAAuBC,CAAvB,GAA4BtB,CAAD,GAAMA,CAAN,GAAU,KAAKoB,QAAL,CAAcC,QAAd,CAAuBC,CAA5D;AACA,SAAKF,QAAL,CAAcC,QAAd,CAAuBG,CAAvB,GAA4BvB,CAAD,GAAMA,CAAN,GAAU,KAAKmB,QAAL,CAAcC,QAAd,CAAuBG,CAA5D;AACA,SAAKJ,QAAL,CAAcK,QAAd;AACH,GA1ED;AA2EA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEItE,EAAAA,gBAAgB,CAACa,SAAjB,CAA2B4E,SAA3B,GAAuC,UAAU5C,CAAV,EAAaC,CAAb,EAAgBN,MAAhB,EAAwB;AAC3D,QAAIkD,KAAK,GAAG,IAAZ;;AACA,QAAIC,SAAS,GAAG;AAAEb,MAAAA,KAAK,EAAE,KAAKb,QAAd;AAAwB2B,MAAAA,MAAM,EAAE,KAAhC;AAAuCC,MAAAA,aAAa,EAAErD;AAAtD,KAAhB;AACA,SAAKvC,MAAL,CAAY6F,OAAZ,CAAoBvG,MAAM,CAACwG,sBAA3B,EAAmDJ,SAAnD,EAA8D,UAAUK,sBAAV,EAAkC;AAC5F,UAAI,CAACA,sBAAsB,CAACJ,MAA5B,EAAoC;AAChC,YAAIK,YAAY,GAAG,KAAK,CAAxB;AACA,YAAIC,eAAe,GAAG,KAAK,CAA3B;AACA,YAAIC,SAAS,GAAG/C,MAAM,CAACgD,gBAAP,CAAwBC,QAAQ,CAACC,IAAjC,CAAhB;AACA,YAAIC,SAAS,GAAGC,UAAU,CAACL,SAAS,CAACM,WAAV,CAAsBC,KAAtB,CAA4B,IAA5B,EAAkC,CAAlC,CAAD,CAAV,GAAmDF,UAAU,CAACL,SAAS,CAACQ,YAAV,CAAuBD,KAAvB,CAA6B,IAA7B,EAAmC,CAAnC,CAAD,CAA7E;AACA,YAAIvB,YAAY,GAAG/B,MAAM,CAACwD,WAA1B;AACA,YAAIrB,WAAW,GAAGnC,MAAM,CAACyD,UAAzB;AACA,YAAIC,QAAQ,GAAGpB,KAAK,CAACzF,MAAN,CAAakB,OAA5B;AACA,YAAI4F,YAAY,GAAG,CAAC/H,iBAAiB,CAAC0G,KAAK,CAACzF,MAAN,CAAa+G,UAAb,EAAD,CAArC;;AACA,YAAIC,QAAQ,GAAGF,YAAY,IAAIrB,KAAK,CAACzF,MAAN,CAAaiH,aAAb,CAA2BC,gBAA3B,EAA/B;;AACA,YAAIC,WAAW,GAAGL,YAAY,IAAIrB,KAAK,CAACzF,MAAN,CAAaiH,aAAb,CAA2BG,sBAA3B,EAAlC;;AACA,YAAIC,UAAU,GAAIP,YAAD,GAAkBE,QAAQ,GAAGG,WAA7B,GAA4C,CAA7D;AACAlI,QAAAA,QAAQ,CAAC,CAACwG,KAAK,CAACvE,OAAP,CAAD,EAAkB,CAAC3B,OAAO,CAAC+H,QAAT,CAAlB,CAAR;;AACA,YAAInI,OAAO,CAACoI,QAAR,IAAoB,CAAC5H,SAAS,EAAlC,EAAsC;AAClCV,UAAAA,QAAQ,CAAC,CAACwG,KAAK,CAACzF,MAAN,CAAa+G,UAAb,EAAD,CAAD,EAA8B,CAACxH,OAAO,CAAC+H,QAAT,CAA9B,CAAR;AACH;;AACD,YAAI7B,KAAK,CAACzF,MAAN,CAAawH,cAAb,CAA4BC,MAAhC,EAAwC;AACpC,cAAIC,MAAM,GAAGjC,KAAK,CAACpF,eAAN,CAAsBsH,QAAtB,GAAiCC,aAA9C;;AACA5B,UAAAA,YAAY,GAAG0B,MAAM,CAACtE,WAAtB;AACA6C,UAAAA,eAAe,GAAGyB,MAAM,CAACf,WAAzB;AACH,SAJD,MAKK;AACD,cAAIe,MAAM,GAAG9I,OAAO,CAAC2D,MAAD,EAAS,MAAMhD,OAAO,CAACsI,eAAvB,CAApB;AACA7B,UAAAA,YAAY,GAAI0B,MAAD,GAAWA,MAAM,CAACI,SAAlB,GAA8B,CAA7C;AACA7B,UAAAA,eAAe,GAAIyB,MAAD,GAAWA,MAAM,CAAC/D,YAAlB,GAAiC,CAAnD;AACH;;AACD,YAAI,CAAC8B,KAAK,CAACzF,MAAN,CAAa+H,UAAb,CAAwBN,MAAzB,IAAmC,CAAC7I,OAAO,CAAC2D,MAAD,EAAS,OAAT,CAA/C,EAAkE;AAC9DkD,UAAAA,KAAK,CAACzF,MAAN,CAAagI,kBAAb,CAAgCvC,KAAK,CAACzF,MAAN,CAAaiI,eAAb,CAA6B7F,KAA7D;;AACAqD,UAAAA,KAAK,CAACzF,MAAN,CAAakI,iBAAb,CAA+B,CAAC,MAAD,EAAS,MAAT,CAA/B;AACH;;AACDvJ,QAAAA,MAAM,CAAC,CAAC8G,KAAK,CAACvE,OAAP,CAAD,EAAkBkF,QAAQ,CAACC,IAA3B,CAAN;AACAZ,QAAAA,KAAK,CAACzB,QAAN,CAAeC,QAAf,CAAwBC,CAAxB,GAA4BtB,CAAC,GAAG,EAAhC;AACA6C,QAAAA,KAAK,CAACzB,QAAN,CAAeC,QAAf,CAAwBG,CAAxB,GAA4BvB,CAAC,GAAG,EAAhC;;AACA4C,QAAAA,KAAK,CAACzB,QAAN,CAAeK,QAAf;;AACAoB,QAAAA,KAAK,CAACzB,QAAN,CAAe9C,OAAf,CAAuBiH,SAAvB,CAAiCC,GAAjC,CAAqC,cAArC;;AACA3C,QAAAA,KAAK,CAAC/E,eAAN,CAAsB2H,eAAtB,CAAsC;AAClC/F,UAAAA,SAAS,EAAEmD,KAAK,CAAC3E,cADiB;AAElCwH,UAAAA,aAAa,EAAE,OAFmB;AAGlClG,UAAAA,KAAK,EAAEqD,KAAK,CAAC/D;AAHqB,SAAtC;;AAKA+D,QAAAA,KAAK,CAAC9E,cAAN,CAAqB4H,sBAArB,CAA4C;AACxCjG,UAAAA,SAAS,EAAEmD,KAAK,CAAC3E,cADuB;AAExCwH,UAAAA,aAAa,EAAE,OAFyB;AAGxClG,UAAAA,KAAK,EAAEqD,KAAK,CAAC/D;AAH2B,SAA5C;;AAKA,YAAI8G,aAAa,GAAG;AAChB5F,UAAAA,CAAC,EAAEA,CADa;AACVC,UAAAA,CAAC,EAAEA,CADO;AAEhBN,UAAAA,MAAM,EAAEA,MAFQ;AAGhBgB,UAAAA,OAAO,EAAEyC,YAHO;AAIhBtC,UAAAA,UAAU,EAAEuC,eAJI;AAKhBpB,UAAAA,KAAK,EAAEY,KAAK,CAACzB,QAAN,CAAe9C,OALN;AAMhBsC,UAAAA,SAAS,EAAEiC,KAAK,CAACzB,QAAN,CAAe9C,OAAf,CAAuByC,YANlB;AAOhBE,UAAAA,QAAQ,EAAE4B,KAAK,CAACzB,QAAN,CAAe9C,OAAf,CAAuB0C,WAPjB;AAQhBkB,UAAAA,aAAa,EAAE+B,QARC;AAShBtB,UAAAA,cAAc,EAAEe,SATA;AAUhB3B,UAAAA,OAAO,EAAExB,MAAM,CAACC,WAVA;AAWhB8B,UAAAA,YAAY,EAAEA,YAXE;AAYhBI,UAAAA,WAAW,EAAEA,WAZG;AAahBjC,UAAAA,UAAU,EAAEwD,QAAQ,CAAC4B,qBAAT,EAbI;AAchBhF,UAAAA,iBAAiB,EAAE4D;AAdH,SAApB;;AAgBA,YAAI9E,MAAM,CAAC4C,OAAP,KAAmB,KAAvB,EAA8B;AAC1BM,UAAAA,KAAK,CAAC/C,WAAN,CAAkB8F,aAAlB;AACH;;AACD,YAAI,CAAC/C,KAAK,CAACzF,MAAN,CAAa+H,UAAb,CAAwBN,MAA7B,EAAqC;AACjChC,UAAAA,KAAK,CAACnB,cAAN,CAAqBkE,aAArB,EAAoC,QAApC,EAA8C,EAA9C;AACH;;AACD/C,QAAAA,KAAK,CAACnB,cAAN,CAAqBkE,aAArB,EAAoC,UAApC,EAAkD/C,KAAK,CAACzF,MAAN,CAAa+H,UAAb,CAAwBN,MAAzB,GAAmC,QAAnC,GAA8C,EAA/F;;AACAhC,QAAAA,KAAK,CAACzB,QAAN,CAAe9C,OAAf,CAAuBiH,SAAvB,CAAiCO,MAAjC,CAAwC,cAAxC;;AACAxJ,QAAAA,WAAW,CAAC,CAACuG,KAAK,CAACvE,OAAP,CAAD,EAAkB,CAAC3B,OAAO,CAAC+H,QAAT,CAAlB,CAAX;;AACA7B,QAAAA,KAAK,CAACzB,QAAN,CAAe2E,IAAf,CAAoB;AAAEC,UAAAA,IAAI,EAAE,QAAR;AAAkBC,UAAAA,QAAQ,EAAG1J,OAAO,CAAC2J,IAAR,GAAe,GAAf,GAAqB;AAAlD,SAApB;;AACA1J,QAAAA,iBAAiB,CAACqG,KAAK,CAACvE,OAAP,EAAgB;AAC7B6H,UAAAA,QAAQ,EAAE5F,MAAM,CAAC6F,UAAP,GAAoB;AADD,SAAhB,CAAjB;AAGA/J,QAAAA,QAAQ,CAAC,CAACwG,KAAK,CAACvE,OAAP,CAAD,EAAkB,CAAC3B,OAAO,CAAC0J,OAAT,CAAlB,CAAR;AACAxD,QAAAA,KAAK,CAACvF,YAAN,GAAqB,IAArB;AACH;AACJ,KA9ED;AA+EH,GAlFD;AAmFA;AACJ;AACA;AACA;AACA;AACA;;;AAEIH,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BsI,SAA3B,GAAuC,YAAY;AAC/C,QAAIC,eAAe,GAAG,KAAKnJ,MAAL,CAAYoJ,gBAAZ,CAA6BC,YAA7B,EAAtB;;AACA,QAAIlK,OAAO,CAACoI,QAAR,IAAoB,CAAC5H,SAAS,EAAlC,EAAsC;AAClCT,MAAAA,WAAW,CAAC,CAAC,KAAKc,MAAL,CAAY+G,UAAZ,EAAD,CAAD,EAA6B,CAACxH,OAAO,CAAC+H,QAAT,CAA7B,CAAX;AACH;;AACD,QAAI,CAACvI,iBAAiB,CAAC,KAAKiB,MAAL,CAAY+G,UAAZ,EAAD,CAAlB,IAAgD,CAAC,KAAK/G,MAAL,CAAY+H,UAAZ,CAAuBN,MAA5E,EAAoF;AAChF,UAAI1I,iBAAiB,CAACoK,eAAD,CAAjB,IAAsCA,eAAe,CAACG,KAAhB,CAAsBC,OAAtB,KAAkC,MAA5E,EAAoF;AAChF,aAAKvJ,MAAL,CAAYkI,iBAAZ,CAA8B,KAAKlI,MAAL,CAAYiI,eAAZ,CAA4B7F,KAA1D;AACH;AACJ;;AACD,SAAKoH,gBAAL;AACA,SAAKtJ,YAAL,GAAoB,KAApB;AACH,GAZD;AAaA;AACJ;AACA;AACA;AACA;AACA;;;AAEIH,EAAAA,gBAAgB,CAACa,SAAjB,CAA2B6I,YAA3B,GAA0C,UAAUC,IAAV,EAAgBC,KAAhB,EAAuB;AAC7D,SAAKtH,YAAL,CAAkBG,UAAlB,CAA6BoH,QAA7B,CAAsC,KAAKvH,YAAL,CAAkBwH,QAAlB,CAA2BH,IAA3B,EAAiC,SAAjC,CAAtC,EAAmFC,KAAnF;AACH,GAFD;AAGA;AACJ;AACA;AACA;AACA;;;AAEI5J,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BkJ,eAA3B,GAA6C,UAAUH,KAAV,EAAiB;AAC1D,SAAKtH,YAAL,CAAkBG,UAAlB,CAA6BuH,WAA7B,CAAyCJ,KAAzC;AACH,GAFD;;AAGA5J,EAAAA,gBAAgB,CAACa,SAAjB,CAA2B4I,gBAA3B,GAA8C,YAAY;AACtD,QAAItI,OAAO,GAAG,KAAK8C,QAAL,CAAc9C,OAA5B;;AACA,QAAI,KAAKhB,YAAT,EAAuB;AACnB,WAAKQ,eAAL,CAAqBsJ,gBAArB;AACA,WAAKrJ,cAAL,CAAoBsJ,kBAApB;AACA/K,MAAAA,WAAW,CAAC,CAAC,KAAKgC,OAAN,CAAD,EAAiB,CAAC3B,OAAO,CAAC0J,OAAT,CAAjB,CAAX;AACAxK,MAAAA,MAAM,CAACyC,OAAD,CAAN;AACA,UAAIG,IAAI,GAAG,KAAK2C,QAAhB;AACA,WAAKhE,MAAL,CAAY6F,OAAZ,CAAoBvG,MAAM,CAAC4K,iBAA3B,EAA8C7I,IAA9C;AACH;AACJ,GAVD;;AAWAtB,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BuJ,YAA3B,GAA0C,UAAU9I,IAAV,EAAgB;AACtD,QAAI+I,OAAO,GAAG;AACV/I,MAAAA,IAAI,EAAEA,IADI;AAEVgJ,MAAAA,cAAc,EAAE,KAAK3J,eAFX;AAGVV,MAAAA,MAAM,EAAE,KAAKA,MAHH;AAIVsK,MAAAA,UAAU,EAAEzL,SAAS,CAAC,MAAMU,OAAO,CAACgL,WAAf,EAA4B,KAAKrJ,OAAjC,CAJX;AAKVsJ,MAAAA,OAAO,EAAE,KAAKnI,YAAL,CAAkBG,UAAlB,CAA6BJ;AAL5B,KAAd;AAOA3C,IAAAA,gBAAgB,CAAC2K,OAAD,EAAU,IAAV,EAAgB,KAAKpK,MAArB,CAAhB;;AACA,QAAI,CAAClB,MAAM,CAAC,oBAAD,EAAuB,KAAKkB,MAAL,CAAYkB,OAAnC,CAAX,EAAwD;AACpDxB,MAAAA,oBAAoB,CAAC,KAAKM,MAAL,CAAYyK,oBAAZ,EAAD,EAAqC,KAAKzK,MAAL,CAAY0K,SAAZ,CAAsBC,aAAtB,CAAoCC,eAApC,CAAoDC,aAApD,EAArC,CAApB;AACH;AACJ,GAZD;AAaA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEI9K,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BkK,OAA3B,GAAqC,YAAY;AAC7C,QAAI,KAAK9G,QAAL,IAAiB,CAAC,KAAKA,QAAL,CAAc+G,WAApC,EAAiD;AAC7C,WAAK/G,QAAL,CAAc8G,OAAd;AACA,WAAKtB,gBAAL;AACH;;AACD,SAAKwB,mBAAL;AACH,GAND;AAOA;AACJ;AACA;AACA;AACA;AACA;;;AAEIjL,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BuB,gBAA3B,GAA8C,YAAY;AACtD,QAAI,KAAKnC,MAAL,CAAY+K,WAAhB,EAA6B;AACzB;AACH;;AACD,SAAK/K,MAAL,CAAYiL,EAAZ,CAAe3L,MAAM,CAACwL,OAAtB,EAA+B,KAAKA,OAApC,EAA6C,IAA7C;AACA,SAAK9K,MAAL,CAAYiL,EAAZ,CAAe3L,MAAM,CAAC4L,YAAtB,EAAoC,KAAKC,iBAAzC,EAA4D,IAA5D;;AACA,QAAI,KAAKnL,MAAL,CAAY+H,UAAZ,CAAuBN,MAA3B,EAAmC;AAC/B,WAAKzH,MAAL,CAAYiL,EAAZ,CAAe3L,MAAM,CAAC8L,cAAtB,EAAsC,KAAKjB,YAA3C,EAAyD,IAAzD;AACH;AACJ,GATD;AAUA;AACJ;AACA;AACA;AACA;AACA;AACA;;;AAEIpK,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BuK,iBAA3B,GAA+C,UAAUxI,CAAV,EAAa;AACxD,QAAI,CAAC5D,iBAAiB,CAAC4D,CAAC,CAAC0I,OAAF,CAAUtD,UAAX,CAAtB,EAA8C;AAC1C,WAAK,IAAIuD,EAAE,GAAG,CAAT,EAAYC,EAAE,GAAGC,MAAM,CAACC,IAAP,CAAY9I,CAAC,CAAC0I,OAAF,CAAUtD,UAAtB,CAAtB,EAAyDuD,EAAE,GAAGC,EAAE,CAACvG,MAAjE,EAAyEsG,EAAE,EAA3E,EAA+E;AAC3E,YAAII,IAAI,GAAGH,EAAE,CAACD,EAAD,CAAb;;AACA,gBAAQI,IAAR;AACI,eAAK,QAAL;AACI,gBAAI/I,CAAC,CAAC0I,OAAF,CAAUtD,UAAV,CAAqBN,MAAzB,EAAiC;AAC7B,mBAAKzH,MAAL,CAAYiL,EAAZ,CAAe3L,MAAM,CAAC8L,cAAtB,EAAsC,KAAKjB,YAA3C,EAAyD,IAAzD;AACH,aAFD,MAGK;AACD,mBAAKnK,MAAL,CAAY2L,GAAZ,CAAgBrM,MAAM,CAAC8L,cAAvB,EAAuC,KAAKjB,YAA5C;AACH;;AACD;AARR;AAUH;AACJ;AACJ,GAhBD;AAiBA;AACJ;AACA;AACA;AACA;AACA;;;AAEIpK,EAAAA,gBAAgB,CAACa,SAAjB,CAA2BoK,mBAA3B,GAAiD,YAAY;AACzD,QAAI,KAAKhL,MAAL,CAAY+K,WAAhB,EAA6B;AACzB;AACH;;AACD,SAAK/K,MAAL,CAAY2L,GAAZ,CAAgBrM,MAAM,CAACwL,OAAvB,EAAgC,KAAKA,OAArC;AACA,SAAK9K,MAAL,CAAY2L,GAAZ,CAAgBrM,MAAM,CAAC4L,YAAvB,EAAqC,KAAKC,iBAA1C;;AACA,QAAI,KAAKnL,MAAL,CAAY+H,UAAZ,CAAuBN,MAA3B,EAAmC;AAC/B,WAAKzH,MAAL,CAAY2L,GAAZ,CAAgBrM,MAAM,CAAC8L,cAAvB,EAAuC,KAAKjB,YAA5C;AACH;AACJ,GATD;;AAUA,SAAOpK,gBAAP;AACH,CAnYqC,EAAtC;;AAoYA,SAASA,gBAAT","sourcesContent":["import { detach, getUniqueID, append, closest, selectAll, select, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { addClass, removeClass, Browser, isNullOrUndefined, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { isCollide } from '@syncfusion/ej2-popups';\nimport * as events from '../base/constant';\nimport * as classes from '../base/classes';\nimport { RenderType } from '../base/enum';\nimport { setToolbarStatus, updateUndoRedoStatus, isIDevice } from '../base/util';\nimport { BaseToolbar } from './base-toolbar';\nimport { DropDownButtons } from './dropdown-buttons';\nimport { ColorPickerInput } from './color-picker';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\nvar BaseQuickToolbar = /** @class */ (function () {\n    function BaseQuickToolbar(parent, locator) {\n        this.parent = parent;\n        this.locator = locator;\n        this.isDOMElement = false;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        this.popupRenderer = this.renderFactory.getRenderer(RenderType.Popup);\n        this.dropDownButtons = new DropDownButtons(this.parent, this.locator);\n        this.colorPickerObj = new ColorPickerInput(this.parent, this.locator);\n    }\n    BaseQuickToolbar.prototype.appendPopupContent = function () {\n        this.toolbarElement = this.parent.createElement('div', { className: classes.CLS_QUICK_TB });\n        this.element.appendChild(this.toolbarElement);\n    };\n    /**\n     * render method\n     *\n     * @param {IQuickToolbarOptions} args - specifies the arguments\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.render = function (args) {\n        var className;\n        if (args.popupType === 'Image') {\n            className = classes.CLS_IMAGE_POP;\n        }\n        else if (args.popupType === 'Inline') {\n            className = classes.CLS_INLINE_POP;\n        }\n        else {\n            className = '';\n        }\n        var popupId = getUniqueID(args.popupType + '_Quick_Popup');\n        this.stringItems = args.toolbarItems;\n        this.element = this.parent.createElement('div', { id: popupId, className: className + ' ' + classes.CLS_RTE_ELEMENTS });\n        this.element.setAttribute('aria-owns', this.parent.getID());\n        this.appendPopupContent();\n        this.createToolbar(args.toolbarItems, args.mode);\n        this.popupRenderer.renderPopup(this);\n        this.addEventListener();\n    };\n    BaseQuickToolbar.prototype.createToolbar = function (items, mode) {\n        this.quickTBarObj = new BaseToolbar(this.parent, this.locator);\n        this.quickTBarObj.render({\n            container: 'quick',\n            target: this.toolbarElement,\n            items: items,\n            mode: mode\n        });\n        this.quickTBarObj.toolbarObj.refresh();\n    };\n    BaseQuickToolbar.prototype.setPosition = function (e) {\n        var x;\n        var y;\n        var imgWrapper = closest(e.target, '.e-img-caption');\n        var target = !isNOU(imgWrapper) ? imgWrapper : e.target;\n        addClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n        var targetOffsetTop = target.offsetTop;\n        var parentOffsetTop = window.pageYOffset + e.parentData.top;\n        if ((targetOffsetTop - e.editTop) > e.popHeight) {\n            y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) - e.popHeight - 5;\n        }\n        else if (((e.editTop + e.editHeight) - (targetOffsetTop + target.offsetHeight)) > e.popHeight) {\n            y = parentOffsetTop + e.tBarElementHeight + (targetOffsetTop - e.editTop) + target.offsetHeight + 5;\n        }\n        else {\n            y = e.y;\n        }\n        if (target.offsetWidth > e.popWidth) {\n            x = (target.offsetWidth / 2) - (e.popWidth / 2) + e.parentData.left + target.offsetLeft;\n        }\n        else {\n            x = e.parentData.left + target.offsetLeft;\n        }\n        this.popupObj.position.X = ((x + e.popWidth) > e.parentData.right) ? e.parentData.right - e.popWidth : x;\n        this.popupObj.position.Y = (y >= 0) ? y : e.y + 5;\n        this.popupObj.dataBind();\n        removeClass([this.toolbarElement], [classes.CLS_RM_WHITE_SPACE]);\n    };\n    BaseQuickToolbar.prototype.checkCollision = function (e, viewPort, type) {\n        var x;\n        var y;\n        var parentTop = e.parentData.top;\n        var contentTop = e.windowY + parentTop + e.tBarElementHeight;\n        var collision = [];\n        if (viewPort === 'document') {\n            collision = isCollide(e.popup);\n        }\n        else {\n            collision = isCollide(e.popup, e.parentElement);\n        }\n        for (var i = 0; i < collision.length; i++) {\n            switch (collision[i]) {\n                case 'top':\n                    if (viewPort === 'document') {\n                        y = e.windowY;\n                    }\n                    else {\n                        y = (window.pageYOffset + parentTop) + e.tBarElementHeight;\n                    }\n                    break;\n                case 'bottom': {\n                    var posY = void 0;\n                    if (viewPort === 'document') {\n                        if (type === 'inline') {\n                            posY = (e.y - e.popHeight - 10);\n                        }\n                        else {\n                            if ((e.windowHeight - (parentTop + e.tBarElementHeight)) > e.popHeight) {\n                                if ((contentTop - e.windowHeight) > e.popHeight) {\n                                    posY = (contentTop + (e.windowHeight - parentTop)) - e.popHeight;\n                                }\n                                else {\n                                    posY = contentTop;\n                                }\n                            }\n                            else {\n                                posY = e.windowY + (parentTop + e.tBarElementHeight);\n                            }\n                        }\n                    }\n                    else {\n                        if (e.target.tagName !== 'IMG') {\n                            posY = (e.parentData.bottom + window.pageYOffset) - e.popHeight - 10;\n                        }\n                        else {\n                            posY = (e.parentData.bottom + window.pageYOffset) - e.popHeight - 5;\n                        }\n                    }\n                    y = posY;\n                    break;\n                }\n                case 'right':\n                    if (type === 'inline') {\n                        x = window.pageXOffset + (e.windowWidth - (e.popWidth + e.bodyRightSpace + 10));\n                    }\n                    else {\n                        x = e.x - e.popWidth;\n                    }\n                    break;\n                case 'left':\n                    if (type === 'inline') {\n                        x = 0;\n                    }\n                    else {\n                        x = e.parentData.left;\n                    }\n                    break;\n            }\n        }\n        this.popupObj.position.X = (x) ? x : this.popupObj.position.X;\n        this.popupObj.position.Y = (y) ? y : this.popupObj.position.Y;\n        this.popupObj.dataBind();\n    };\n    /**\n     * showPopup method\n     *\n     * @param {number} x - specifies the x value\n     * @param {number} y - specifies the y value\n     * @param {Element} target - specifies the element\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.showPopup = function (x, y, target) {\n        var _this = this;\n        var eventArgs = { popup: this.popupObj, cancel: false, targetElement: target };\n        this.parent.trigger(events.beforeQuickToolbarOpen, eventArgs, function (beforeQuickToolbarArgs) {\n            if (!beforeQuickToolbarArgs.cancel) {\n                var editPanelTop = void 0;\n                var editPanelHeight = void 0;\n                var bodyStyle = window.getComputedStyle(document.body);\n                var bodyRight = parseFloat(bodyStyle.marginRight.split('px')[0]) + parseFloat(bodyStyle.paddingRight.split('px')[0]);\n                var windowHeight = window.innerHeight;\n                var windowWidth = window.innerWidth;\n                var parent_1 = _this.parent.element;\n                var toolbarAvail = !isNullOrUndefined(_this.parent.getToolbar());\n                var tbHeight = toolbarAvail && _this.parent.toolbarModule.getToolbarHeight();\n                var expTBHeight = toolbarAvail && _this.parent.toolbarModule.getExpandTBarPopHeight();\n                var tBarHeight = (toolbarAvail) ? (tbHeight + expTBHeight) : 0;\n                addClass([_this.element], [classes.CLS_HIDE]);\n                if (Browser.isDevice && !isIDevice()) {\n                    addClass([_this.parent.getToolbar()], [classes.CLS_HIDE]);\n                }\n                if (_this.parent.iframeSettings.enable) {\n                    var cntEle = _this.contentRenderer.getPanel().contentWindow;\n                    editPanelTop = cntEle.pageYOffset;\n                    editPanelHeight = cntEle.innerHeight;\n                }\n                else {\n                    var cntEle = closest(target, '.' + classes.CLS_RTE_CONTENT);\n                    editPanelTop = (cntEle) ? cntEle.scrollTop : 0;\n                    editPanelHeight = (cntEle) ? cntEle.offsetHeight : 0;\n                }\n                if (!_this.parent.inlineMode.enable && !closest(target, 'table')) {\n                    _this.parent.disableToolbarItem(_this.parent.toolbarSettings.items);\n                    _this.parent.enableToolbarItem(['Undo', 'Redo']);\n                }\n                append([_this.element], document.body);\n                _this.popupObj.position.X = x + 20;\n                _this.popupObj.position.Y = y + 20;\n                _this.popupObj.dataBind();\n                _this.popupObj.element.classList.add('e-popup-open');\n                _this.dropDownButtons.renderDropDowns({\n                    container: _this.toolbarElement,\n                    containerType: 'quick',\n                    items: _this.stringItems\n                });\n                _this.colorPickerObj.renderColorPickerInput({\n                    container: _this.toolbarElement,\n                    containerType: 'quick',\n                    items: _this.stringItems\n                });\n                var showPopupData = {\n                    x: x, y: y,\n                    target: target,\n                    editTop: editPanelTop,\n                    editHeight: editPanelHeight,\n                    popup: _this.popupObj.element,\n                    popHeight: _this.popupObj.element.offsetHeight,\n                    popWidth: _this.popupObj.element.offsetWidth,\n                    parentElement: parent_1,\n                    bodyRightSpace: bodyRight,\n                    windowY: window.pageYOffset,\n                    windowHeight: windowHeight,\n                    windowWidth: windowWidth,\n                    parentData: parent_1.getBoundingClientRect(),\n                    tBarElementHeight: tBarHeight\n                };\n                if (target.tagName === 'IMG') {\n                    _this.setPosition(showPopupData);\n                }\n                if (!_this.parent.inlineMode.enable) {\n                    _this.checkCollision(showPopupData, 'parent', '');\n                }\n                _this.checkCollision(showPopupData, 'document', ((_this.parent.inlineMode.enable) ? 'inline' : ''));\n                _this.popupObj.element.classList.remove('e-popup-open');\n                removeClass([_this.element], [classes.CLS_HIDE]);\n                _this.popupObj.show({ name: 'ZoomIn', duration: (Browser.isIE ? 250 : 400) });\n                setStyleAttribute(_this.element, {\n                    maxWidth: window.outerWidth + 'px'\n                });\n                addClass([_this.element], [classes.CLS_POP]);\n                _this.isDOMElement = true;\n            }\n        });\n    };\n    /**\n     * hidePopup method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.hidePopup = function () {\n        var viewSourcePanel = this.parent.sourceCodeModule.getViewPanel();\n        if (Browser.isDevice && !isIDevice()) {\n            removeClass([this.parent.getToolbar()], [classes.CLS_HIDE]);\n        }\n        if (!isNullOrUndefined(this.parent.getToolbar()) && !this.parent.inlineMode.enable) {\n            if (isNullOrUndefined(viewSourcePanel) || viewSourcePanel.style.display === 'none') {\n                this.parent.enableToolbarItem(this.parent.toolbarSettings.items);\n            }\n        }\n        this.removeEleFromDOM();\n        this.isDOMElement = false;\n    };\n    /**\n     * @param {string} item - specifies the string value\n     * @param {number} index - specifies the index value\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.addQTBarItem = function (item, index) {\n        this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(item, 'toolbar'), index);\n    };\n    /**\n     * @param {number} index - specifies the index value\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.removeQTBarItem = function (index) {\n        this.quickTBarObj.toolbarObj.removeItems(index);\n    };\n    BaseQuickToolbar.prototype.removeEleFromDOM = function () {\n        var element = this.popupObj.element;\n        if (this.isDOMElement) {\n            this.dropDownButtons.destroyDropDowns();\n            this.colorPickerObj.destroyColorPicker();\n            removeClass([this.element], [classes.CLS_POP]);\n            detach(element);\n            var args = this.popupObj;\n            this.parent.trigger(events.quickToolbarClose, args);\n        }\n    };\n    BaseQuickToolbar.prototype.updateStatus = function (args) {\n        var options = {\n            args: args,\n            dropDownModule: this.dropDownButtons,\n            parent: this.parent,\n            tbElements: selectAll('.' + classes.CLS_TB_ITEM, this.element),\n            tbItems: this.quickTBarObj.toolbarObj.items\n        };\n        setToolbarStatus(options, true, this.parent);\n        if (!select('.e-rte-srctextarea', this.parent.element)) {\n            updateUndoRedoStatus(this.parent.getBaseToolbarObject(), this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());\n        }\n    };\n    /**\n     * Destroys the Quick toolbar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.destroy = function () {\n        if (this.popupObj && !this.popupObj.isDestroyed) {\n            this.popupObj.destroy();\n            this.removeEleFromDOM();\n        }\n        this.removeEventListener();\n    };\n    /**\n     * addEventListener method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        if (this.parent.inlineMode.enable) {\n            this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n        }\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the model element\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.onPropertyChanged = function (e) {\n        if (!isNullOrUndefined(e.newProp.inlineMode)) {\n            for (var _i = 0, _a = Object.keys(e.newProp.inlineMode); _i < _a.length; _i++) {\n                var prop = _a[_i];\n                switch (prop) {\n                    case 'enable':\n                        if (e.newProp.inlineMode.enable) {\n                            this.parent.on(events.toolbarUpdated, this.updateStatus, this);\n                        }\n                        else {\n                            this.parent.off(events.toolbarUpdated, this.updateStatus);\n                        }\n                        break;\n                }\n            }\n        }\n    };\n    /**\n     * removeEventListener method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    BaseQuickToolbar.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        if (this.parent.inlineMode.enable) {\n            this.parent.off(events.toolbarUpdated, this.updateStatus);\n        }\n    };\n    return BaseQuickToolbar;\n}());\nexport { BaseQuickToolbar };\n"]},"metadata":{},"sourceType":"module"}